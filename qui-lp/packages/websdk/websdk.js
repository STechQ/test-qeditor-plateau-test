!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.websdk=t():e.websdk=t()}(this,()=>(()=>{"use strict";var __webpack_modules__={76407(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePromiseData=void 0;var r=!1;new Promise(function(e){return e()}).then(function(){return r=!0}),"undefined"!=typeof doNothing&&doNothing();var n=!0===r;t.CreatePromiseData=function(e,t){void 0===t&&(t={});var r,o=void 0,s=void 0,i=function(e){r&&clearTimeout(r),r=setTimeout(function(){s(new Error("The operation has timed out. timeoutValue  : "+e))},e)};return e&&i(e),{startTimer:i,promise:new Promise(function(e,r){var i;i=e,o=n&&t.fixSyncResolve?function(e){return setTimeout(function(){return i(e)})}:i,s=r}),resolver:o,reject:s}}},79681(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.CryptoHelper=void 0;var CryptoHelper=function(){function CryptoHelper(){}return CryptoHelper.generateRandom=function(nums){var characters="0123456789abcdefghijklmnopqrstuvwxyz",sum=nums.reduce(function(e,t){return e+t},0),isomorphicCrypto="undefined"!=typeof crypto?eval("crypto"):eval("require")("crypto"),randomValues=isomorphicCrypto.getRandomValues(new Uint8Array(sum)),index=0;return nums.reduce(function(e,t){return e.push(Array.from(new Array(t)).map(function(e){return characters[randomValues[index++]%characters.length]}).join("")),e},[])},CryptoHelper.CreateGuid=function(){var e=Date.now().toString(36).substring(0,9).padStart(9,"0");return CryptoHelper.generateRandom([8,4,4,4,3]).join("-")+e},CryptoHelper}();exports.CryptoHelper=CryptoHelper},90222(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=void 0;var n=r(24603),o=function(){function e(){this.subsDict={}}return e.prototype.obtainSubsList=function(e){return this.subsDict[e]||(this.subsDict[e]=new n.Hook("EventBus_"+e))},e.prototype.Subscribe=function(t,r){if(t==e.AllEvents)throw new Error(t+" is a registered key. If you want to subscribe all events, use SubsribeAll().");this.obtainSubsList(t).subscribe(r)},e.prototype.Unsubscribe=function(t,r){var n;if(t==e.AllEvents)throw new Error(t+" is a registered key. If you want to subscribe all events, use SubsribeAll().");null===(n=this.subsDict[t])||void 0===n||n.unsubscribe(r)},e.prototype.SubscribeAll=function(t){this.obtainSubsList(e.AllEvents).subscribe(t)},e.prototype.UnsubscribeAll=function(t){var r;null===(r=this.subsDict[e.AllEvents])||void 0===r||r.unsubscribe(t)},e.prototype.Trigger=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.subsDict[e.AllEvents];if(null==o||o.triggerer.apply(o,r),t!=e.AllEvents){var s=this.subsDict[t];null==s||s.triggerer.apply(s,r)}},e.prototype.TriggerJustAllSubs=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.subsDict[e.AllEvents];null==n||n.triggerer.apply(n,t)},e.prototype.destroy=function(){this.subsDict={}},e.AllEvents="AllEvents",e}();t.EventBus=o},88644(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.FrameCommunicator=void 0;var n=r(19778),o=function(){function e(e){var t=this;this.OnMessageWithDirectObject=!0,this.targetWindow=e,window.addEventListener("message",this.messageHandler=function(r){var n;r.source==e&&(null===(n=t.OnMessage)||void 0===n||n.call(t,r.data))})}return e.prototype.Send=function(e){this.targetWindow.postMessage(e,"*")},e.prototype.destroy=function(){window.removeEventListener("message",this.messageHandler),this.OnMessage=void 0},e}(),s=function(){function e(e){this.windowSocket=new o(e),this.structuredSocket=new n.StructuredSocket(this.windowSocket)}return e.prototype.Send=function(e,t,r,n){return this.structuredSocket.Send(r,n)},e.prototype.Subscribe=function(e,t,r){this.structuredSocket.Subscribe(t,r)},e.prototype.SubscribeAll=function(e){this.structuredSocket.SubscribeAll(function(t){return e(t)})},e.prototype.UnsubscribeAll=function(e){this.structuredSocket.UnsubscribeAll(function(t){return e(t)})},e.prototype.destroy=function(){this.structuredSocket.destroy()},e}();t.FrameCommunicator=s},24603(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}c((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Hook=void 0,r(21941);var s=function(){function e(e,t){void 0===t&&(t={}),this.subscribers=[],this.hookName=e,this.triggerPostSubscribersWithCb=t.triggerPostSubscribersWithCb||!1,t.manageState=t.manageState||!1,this.hookState={triggered:!1,triggerArgs:[],active:t.manageState}}return e.configure=function(t){e.logger=t},Object.defineProperty(e.prototype,"TriggerPostSubscribersWithCb",{get:function(){return this.triggerPostSubscribersWithCb},set:function(e){this.triggerPostSubscribersWithCb=e},enumerable:!1,configurable:!0}),e.prototype.ResetAndStartState=function(){this.hookState.triggerArgs=[],this.hookState.active=!0,this.hookState.triggered=!1},e.prototype.DisableState=function(){this.hookState.triggerArgs=[],this.hookState.active=!1,this.hookState.triggered=!1},e.prototype.IsTriggered=function(){if(!this.hookState.active)throw new Error("IsTriggered can not be checked on a non manageState Hook: "+this.hookName);return this.hookState.triggered},e.prototype.getHookName=function(){var e=this.hookName;return e.toLowerCase().endsWith("hook")||(e+=" hook"),e},Object.defineProperty(e.prototype,"hasSubscribers",{get:function(){return this.subscriberCount>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subscriberCount",{get:function(){return this.subscribers.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPostSubscribers",{get:function(){var e,t;return!0===((null===(e=this.postSubscribers)||void 0===e?void 0:e.hasPostSubscribers)||(null===(t=this.postSubscribers)||void 0===t?void 0:t.hasSubscribers))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"triggerer",{get:function(){return this.trigger},enumerable:!1,configurable:!0}),e.prototype.trigger=function(){for(var e,t=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this.hookState.active&&(this.hookState.triggered=!0,this.hookState.triggerArgs=r),this.subscribers.forEach(function(e){return t.tryTriggerSubscriber(e,r)}),this.triggerPostSubscribersWithCb||null===(e=this.postSubscribers)||void 0===e||e.triggerer.apply(this.postSubscribers,r)},e.prototype.tryTriggerSubscriber=function(t,r){return n(this,void 0,void 0,function(){var n,s;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.apply(null,r)];case 1:return o.sent(),[3,3];case 2:return n=o.sent(),s=this.getHookName()+" subscriber failed",e.logger?(e.logger.log({error:n,message:s}),[2]):(console.error(s,n),[3,3]);case 3:return[2]}})})},e.prototype.triggerPostSubscribers=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];null===(e=this.postSubscribers)||void 0===e||e.triggerer.apply(this.postSubscribers,t)},e.prototype.postSubscribe=function(t){this.postSubscribers||(this.postSubscribers=new e(this.hookName+"_Post",{manageState:this.hookState.active}),this.postSubscribers.hookState=this.hookState),this.postSubscribers.subscribe(t)},e.prototype.postUnsubscribe=function(e){var t;null===(t=this.postSubscribers)||void 0===t||t.unsubscribe(e)},e.prototype.clearPostSubscribers=function(e){var t;void 0===e&&(e=!1),null===(t=this.postSubscribers)||void 0===t||t.clearSubscribers(),!e&&this.hasPostSubscribers||(this.postSubscribers=void 0)},e.prototype.forceClearAllSubscibers=function(){this.clearPostSubscribers(!0),this.clearSubscribers()},e.prototype.subscribe=function(e){this.subscribers.push(e),this.hookState.active&&this.hookState.triggered&&this.tryTriggerSubscriber(e,this.hookState.triggerArgs)},e.prototype.clearSubscribers=function(){this.subscribers=[]},e.prototype.unsubscribe=function(e){this.subscribers=this.subscribers.filter(function(t){return t!=e})},e}();t.Hook=s},93857(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var r,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.importModuleBody=t.importModuleFile=t.importModule=t.importScript=void 0;var i=r(76407);function a(e){return o(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,fetch(e)];case 1:return[4,t.sent().text()];case 2:return[2,t.sent()]}})})}function c(e,t,r,n){void 0===r&&(r="default");var o={};return new Function("module","exports","require","params","__tempPlateauUIParams__",e)(o,{},t,n,n),"*"==r?o.exports:o.exports[r]}t.importScript=function(e,t,r,a){return void 0===r&&(r="default"),o(this,void 0,void 0,function(){var o,c,l;return s(this,function(s){switch(s.label){case 0:return window.__tempPlateauUIParams__=a,o=(0,i.CreatePromiseData)(),(c=document.createElement("script")).src=e,c.onload=function(){return o.resolver()},c.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];delete window.__tempPlateauUIParams__,o.reject(n({},e))},document.body.appendChild(c),[4,o.promise];case 1:s.sent(),delete window.__tempPlateauUIParams__,l=window[t];try{delete window[t]}catch(e){}return[2,"*"==r?l:l[r]]}})})},t.importModule=function(e,t,r,n){return void 0===r&&(r="default"),o(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,a(e)];case 1:return[2,c(o.sent(),t,r,n)]}})})},t.importModuleFile=a,t.importModuleBody=c},19778(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.StructuredSocket=void 0;var n=r(76407),o=r(79681),s=r(90222),i=function(){function e(e){this.socket=e,this.awaitMsgList={},this.eventBus=new s.EventBus,e.OnMessage=this.listen.bind(this)}return e.prototype.CreatePackage=function(e,t){return{msg:e,id:o.CryptoHelper.CreateGuid(),replyId:t.replyId}},e.prototype.Send=function(e,t){var r=this.CreatePackage(e,t);if(this.socket.Send(r,{transferBuffers:t.transferBuffers}),t.awaitResponse){var o=(0,n.CreatePromiseData)(t.awaitTime);return this.awaitMsgList[r.id]={promData:o},o.promise}},e.prototype.Subscribe=function(e,t){this.eventBus.Subscribe(e,t)},e.prototype.Unsubscribe=function(e,t){this.eventBus.Unsubscribe(e,t)},e.prototype.SubscribeAll=function(e){this.eventBus.SubscribeAll(e)},e.prototype.UnsubscribeAll=function(e){this.eventBus.UnsubscribeAll(e)},e.prototype.tryLogJsonParseEx=function(e){try{return JSON.parse(e)}catch(c){var t=c;if(!t.message)throw c;var r=t.message.indexOf("in JSON at position");if(r<=-1)throw c;var n=t.message.substring(r+19),o=Number(n);if(isNaN(o))throw c;var s=o<30?0:o-30,i=o>e.length-30?e.length:o+30,a=e.substring(s,i);throw console.log(a+"\n"+" ".repeat(o-s)+"^"),c}},e.prototype.ConvertBufferToStructure=function(e){try{var t=this.socket.OnMessageWithDirectObject?e:this.tryLogJsonParseEx(e.toString());return t?t.msg&&t.msg.type?t:void console.log("unexpected message format: missing {msg:{type: ... }} structure"):void console.log("unexpected message format: undefined")}catch(e){return void console.log("unexpected message format: json.parse error: ",e)}},e.prototype.listen=function(e){var t=this.ConvertBufferToStructure(e);if(t){if(t.replyId){var r=this.awaitMsgList[t.replyId];return r&&(delete this.awaitMsgList[t.replyId],r.promData.resolver(t)),void this.eventBus.TriggerJustAllSubs(t)}this.eventBus.Trigger(t.msg.type,t)}},e.prototype.destroy=function(e){this.socket.destroy();var t=this.awaitMsgList;this.awaitMsgList={},this.eventBus.destroy();var r=new Error(e||"structuredSocket destroyed with no reason specified");Object.keys(t).forEach(function(e){var n;return null===(n=t[e])||void 0===n?void 0:n.promData.reject(r)})},e}();t.StructuredSocket=i},21941(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e})},65654(e,t,r){t.Fl=void 0;var n=r(88644),o=function(){function e(){}return e.CreatePlateauMessaging=function(e){return new n.FrameCommunicator(e)},e}();t.Fl=o},75039(e,t,r){r.d(t,{k:()=>u});var n=r(55049),o=r(72745),s=r(84308),i=r(90073),a=r(98535);class c{constructor({moduleManager:e}){this.moduleManager=e}collectQJson(e,t,r,o,i,c,l){let u=[];const g=r.GetEditMode(),{qLang:p,level:d=0}=l;!g&&e.dm.length>0&&i.cacheItems(e.dm);const h=e=>{e&&e.forEach(async e=>{if(e){switch(e.T){case a.G.customComponent.name:case a.G.renderingComponent.name:const t=r.Evaluate({script:e.P[a.G.customComponent.props.qjsonPath]?.H,response:null,lang:s.o.getLang({ctrl:e,qLang:p})});t&&u.push({type:"qjson",qProm:o(t),qJsonPath:t,subPromiseList:[]});break;case a.G.messaging.name:if(g)break;const n=e.P[a.G.messaging.props.masterPath],i=n&&r.Evaluate({script:n.H,response:null,lang:s.o.getLang({ctrl:e,qLang:p})});i&&u.push({type:"masterPage",qProm:o(i),qJsonPath:i,subPromiseList:[]});break;default:const c=this.moduleManager.CheckComponent(e.T,e.CP);c&&u.push({type:"domainComp",prom:c,compPath:e.CP,compName:e.T,subPromiseList:[]})}e.C&&Object.keys(e.C).forEach(t=>h(e.C[t].c))}})};return h(e.qjson.cJson),new Promise(async(s,a)=>{const l=c?.GetLastHistory()?.masterData?.path;let g=!1,h={qjson:e.qjson},b=0;function f(){0!=d||!l||g?s(h):a(new Error("Not implemented: Navigating from a page with a masterPage to a page with no masterPage"))}u.length?(await Promise.all(u.map(async e=>{try{if("domainComp"==e.type)return void await e.prom;const n=await e.qProm;"masterPage"==e.type&&(g=!0)&&(h=this.handleMasterPage(n.qjson,e.qJsonPath,t,l)||h),await this.collectQJson(n,e.qJsonPath,r,o,i,c,{qLang:p,level:d+1})}catch(t){const r="domainComp"!=e.type?e.qJsonPath:e.compName+(e.compPath?" "+e.compPath:""),o=`Error on collectQJson ${e.type}: ${r}: ${t.message}`;n.V.Log({logMessage:o,error:t,logType:n.F.Error})}finally{b++,b===u.length&&f()}})),f()):f()})}handleMasterPage(e,t,r,o){if(o==t)return void n.V.Log({logMessage:"page has masterPage but previous page had the same master, so pass",logType:n.F.Trace});if(o&&o!=t)throw new Error("Not implemented: Navigating from a page with a masterPage to a page with a different masterPage");const s=structuredClone(e),c=i.k.findComponentByType(s.cJson,a.G.renderingComponent.name);if(c){if(r)return c.P.QJsonPath={H:`╬'${r}'╩╩`,T:"prop",HL:"QS"},{qjson:s,changedPath:t};n.V.Log({logMessage:"page has a masterPage, but does not know self path",logType:n.F.Warning})}else n.V.Log({logMessage:"page had masterPage but masterPage does not have RenderingComponent",logType:n.F.Warning})}}function l(e){return async t=>{const n=await r.e(8919).then(r.bind(r,98919));return Object.keys(n).forEach(e=>t[e]=n[e]),{qjson:n[e],dm:[]}}}class u{constructor({qjsonRetriever:e,moduleManager:t,cacheDict:r}){this.contextName=u.contextName,this.qJsonPool={},this.qjsonRetriever=e,this.moduleManager=t,this.cacheDict=r,this.qjsonCollector=new c({moduleManager:t}),this.ResetPool()}ResetPool(){const e=this;this.qJsonPool={get"qjson://QLegend"(){return l("QLegend")(e.qJsonPool)},get"qjson://QCaptcha"(){return l("QCaptcha")(e.qJsonPool)},get"qjson://QDynamicFields"(){return l("QDynamicFields")(e.qJsonPool)},get"qjson://QQRCode"(){return l("QQRCode")(e.qJsonPool)}}}get ModuleManager(){return this.moduleManager}async retrieveAndFillQjsonAsync({qjson:e,dory:t,doryJr:r}){const s=this,i=e,a=async function(e,r){let a=s.qJsonPool[e];if(a)return"function"==typeof a?a(s.qJsonPool):a instanceof Promise?await a:a;{const c=s.qjsonRetriever.retrieveQJsonAsync(e,i.options);let l=s.qjsonRetriever.disablePagePool;try{const t=(async()=>{const{qjson:e,jsonString:t}=o.x.qJsonExtractor2(await c);return{qjson:e,dm:s.cacheDict.extractDependentIds(t)}})();l||(s.qJsonPool[e]=t),a=await t,l||(s.qJsonPool[e]=a)}catch(r){throw n.V.Log({logMessage:`qjson error: ${e} has error`,logType:n.F.Trace,additional:r,minEngineLogLevel:t.GetLogParams()?.minEngineLogLevel}),r}return a}},c="content"==e.type?(e=>({qjson:e,dm:this.cacheDict.extractDependentIds(JSON.stringify(e))}))(e.content):await a(e.path),l="content"==e.type?void 0:e.path;return await this.qjsonCollector.collectQJson(c,l,t,a,this.cacheDict,r,{qLang:c.qjson.opt?.QL})}getCJson(e){const t=this.qJsonPool[e];if(t)return t.qjson}}u.contextName="QJsonPool"},98535(e,t,r){r.d(t,{G:()=>n,R:()=>o});const n={renderingComponent:{name:"RenderingComponent",props:{qjsonPath:"QJsonPath",readonly:"readonly",disabled:"disabled"}},customComponent:{name:"CustomComponent",props:{qjsonPath:"QJsonPath",readonly:"readonly",disabled:"disabled"}},messaging:{name:"Messaging",props:{masterPath:"masterPath"}}},o=["QPieChart","QQrReader"]},90073(e,t,r){r.d(t,{h:()=>n,k:()=>s});var n,o=r(74590);!function(e){e[e.PID=0]="PID",e[e.EditorID=1]="EditorID",e[e.Render=2]="Render"}(n||(n={}));class s{static ForEachComp(e,t,r,n){var o=function({curJson:e,path:r,parentCompJson:s,compiledJson:i}){if(!e||0===e.length)return void console.error("curJson is empty or undefined");const a=n?-1:1,c=n?e.length-1:0,l=n?-1:e.length;for(let n=c;n!==l;n+=a){const a=e[n],c=i?.[n];if(a){if(r.push(n),!1===t(a,r.map(e=>e),{compName:a.T,eID:a._Editor.eID,parentCompJson:s,compiledJson:c}))return!1;if(a.C)for(var u in a.C){if(r.push(u),!1===o({curJson:a.C[u].c,path:r,parentCompJson:a,compiledJson:c?.C[u]?.c}))return!1;r.pop()}r.pop()}}};o({curJson:e,path:[],compiledJson:r})}static findComponentByType(e,t){let r;return s.ForEachComp(e,e=>e.T!=t||(r=e,!1)),r}findParentArrayPath(e,t){return s.FindParentArrayPath(e,t)}static FindParentArrayPath(e,t){let r=null;const n=e.pop();if(0==e.length)return{selfIndex:n,parentArray:t,parent:null};let s=t;const i=new o.B;for(let t=0;t<e.length;t++){const n=e[t];i.isObject(s)?(r=s,s=r?.C[n]?.c||[]):s=s[n]||[]}return{selfIndex:n,parentArray:s,parent:r}}findCompBySearchField(e,t,r=n.EditorID){return s.FindCompBySearchField(e,t,r)}static FindCompBySearchField(e,t,r=n.EditorID,o){let i=null;return s.ForEachComp(e,(e,o)=>(e=>{switch(r){case n.PID:return e.P?.ID?.H;case n.Render:return e.P?.Render?.H;case n.EditorID:default:return e._Editor?.eID}})(e)!==t||(i={compJson:e,curPath:o},!1),void 0,o),i}static ParseParameters(e,t){if(e){const r="TS"==t||"JS"==t?e=>({name:e.split(":")[0],type:e.split(":")[1]}):e=>({name:e});return e.split(",").map(r)}}static FindCompPathByEID(e,t){let r;return s.ForEachComp(e,(e,n)=>e._Editor.eID!=t||(r=n,!1)),r}}},17143(e,t,r){r.d(t,{w:()=>n});class n{static LoadModule(e){const t={};return new Function("module","exports",e)(t,{}),t.exports}static FetchModuleBody(e){return new Promise((t,r)=>fetch(e).then(e=>e.text().then(r=>t({body:r,status:e.status})).catch(r)).catch(r))}}},55049(e,t,r){var n;r.d(t,{F:()=>n,V:()=>a}),function(e){e[e.Debug=0]="Debug",e[e.MobilDebug=1e3]="MobilDebug",e[e.Trace=2e5]="Trace",e[e.Warning=5e5]="Warning",e[e.Error=1e6]="Error"}(n||(n={}));class o{constructor(){this.bulkMessages=[],this.totalBulk=0}writeMessage(e){this.bulkSize?(this.totalBulk+=e.message.length,this.bulkMessages.push(e),this.totalBulk>=this.bulkSize&&(this.logHandler?.(this.bulkMessages),this.totalBulk=0,this.bulkMessages=[])):this.logHandler?.(e)}}var s=r(24227);class i{static trySingularize(e,t){return!this.singularized(e)&&(s.z.Instance.Window[e]=t,!0)}static singularized(e){return s.z.Instance.Window[e]}static getFreeName(e){const t=s.z?.Instance.Window??{};let r=0;for(;t[e+"_"+ ++r];);return e+"_"+r}}class a{constructor(){return{Log:this.Log}}static get LogBulkManager(){return a.logBulkManager||(a.logBulkManager=i.singularized(a.windowName)),a.logBulkManager}static Init({callBack:e,bulkSize:t}){this.logBulkManager=new o,this.logBulkManager.logHandler=e,this.logBulkManager.bulkSize=t,i.trySingularize(this.windowName,this.logBulkManager)}static Log({logMessage:e,logType:t=n.Debug,error:r,backgroundColor:o=null,textColor:s=null,additional:i=null,source:c,isClientLog:l=!1,yamlLogType:u,minEngineLogLevel:g,ownerEventName:p}){let d,h=o||s?"background: "+o+"; color: "+s:null;switch(!0){case t==n.MobilDebug&&this.logLevel.indexOf(n.MobilDebug)>-1:case t==n.Debug&&this.logLevel.indexOf(n.Debug)>-1:case t==n.Trace&&this.logLevel.indexOf(n.Trace)>-1:d=console.log;break;case t==n.Error&&this.logLevel.indexOf(n.Error)>-1:d=console.error;break;case t==n.Warning&&this.logLevel.indexOf(n.Warning)>-1:d=console.warn}let b=[e];h&&"string"==typeof e&&(b[0]="%c"+e,b.push(h)),r&&b.push(r),i&&b.push(i),c&&b.push({source:c}),a.checkEventNameIsSpecial(p)&&!l||(b[3]={clientOnlyLog:!0}),d?.apply(console,b),a.checkEventNameIsSpecial(p)&&(l||l&&u&&u<=t||g&&g<=t)&&this.prepareClientLog(e,t,l)}static checkEventNameIsSpecial(e){return!e||!("onBeforeRequest"===e||"onAfterResponse"===e||"logHandler"===e)}static prepareClientLog(e,t,r){let o,s=new Date(Date.now()),i=s.getFullYear()+"."+("0"+(s.getMonth()+1)).slice(-2)+"."+("0"+s.getDate()).slice(-2)+" "+s.getHours()+":"+("0"+s.getMinutes()).slice(-2)+":"+("0"+s.getSeconds()).slice(-2)+":"+s.getMilliseconds(),c=this.getCalleFunctionName();if("string"!=typeof e)try{o=this.shorten(JSON.stringify(e),t)}catch(t){o="Can not stringfy the given log. Type of log data is: "+Object.prototype.toString.call(e)}else o=this.shorten(e,t);a.LogBulkManager?.writeMessage({message:o,type:n[t],time:i,caller:c,isClientLog:r})}static getCalleFunctionName(){return""}static clearLogs(){a.LogBulkManager?.clear?.()}static shorten(e,t){return e}Log(e){return a.Log(e)}}a.windowName=i.getFreeName("shrimp_shelldorynemo_pulsar_lbm"),a.logLevel=[n.MobilDebug,n.Trace,n.Debug,n.Warning,n.Error]},72745(e,t,r){r.d(t,{x:()=>i});class n{static ParseQJsonContent(e){let t=e;if(e.indexOf("let pjson =")>-1){let r=e.split("let pjson =");r=r[1].split(";\nexport")[0].split(";\r\nexport"),t=r[0]}else if(t.indexOf("rally_microUI")>-1){const e=t.indexOf("registerQJson"),r=t.indexOf(",",e)+1;t=t.substring(r,t.length-2)}return JSON.parse(t)}}class o{static QJsonBodyToString(e,t){return"let pjson = "+(1==t?JSON.stringify(e):JSON.stringify(e,null,"\t"))+";\r\nexport default pjson"}Serialize(e){const t=`${o.boundary}\r\n`,r=`${o.headerPrefix}v2\r\nboundary: ${t}\r\n${t}`,n=(e,t,r)=>`name: ${e}\r\ntype: ${t}\r\n\r\n${r}`,s=e.files,i=e.cFiles;let a;try{e.files=void 0,e.cFiles=void 0,a=n("qjson","qjson",o.QJsonBodyToString(e))}finally{e.files=s,e.cFiles=i}return r+a+(s?t+Object.keys(s).map(e=>n(e,"source",s[e])).join(t):"")+(i?t+Object.keys(i).map(e=>n(e,"compiled",i[e])).join(t):"")}Parse(e){let t=this.nextLine(e,0),r=this.extractHeaders(e,t.lastIndex);const o=r.headers.boundary;let s=r.lastIndex;const i={},a={};do{const t=this.getSection(e,o,s);("compiled"==t.headers.type?a:i)[t.headers.name]={headers:t.headers,content:t.section},s=t.lastIndex}while(-1!=s);const c=n.ParseQJsonContent(i.qjson.content);delete i.qjson;const l=c.files={},u=c.cFiles={};return Object.keys(i).forEach(e=>l[e]=i[e].content),Object.keys(a).forEach(e=>u[e]=a[e].content),c}getSection(e,t,r){let n=this.extractHeaders(e,r);const o=this.getTillBoundary(e,t,n.lastIndex);return{headers:n.headers,section:o.section,lastIndex:o.lastIndex}}getTillBoundary(e,t,r){const n=e.indexOf(t,r);return-1==n?{section:e.substring(r),lastIndex:-1}:{section:e.substring(r,n),lastIndex:n+t.length+1}}extractHeaders(e,t){const r={};let n={line:"",lastIndex:t};do{if(n=this.nextLine(e,n.lastIndex),!n.line)break;const t=this.parseLine(n.line);t&&(r[t.key]=t.value)}while(-1!=n.lastIndex);return{headers:r,lastIndex:n.lastIndex}}parseLine(e){const t=e.indexOf(":");if(-1!=t)return{key:e.substring(0,t).trim(),value:e.substring(t+1).trim()}}nextLine(e,t){const r=e.indexOf("\n",t);return{line:s(e.substring(t,-1==r?void 0:r)),lastIndex:r+1||-1}}}function s(e){return e.endsWith("\r")?e.substring(0,e.length-1):e}o.boundary="-------------------QJSONFileBoundary-----------------------------",o.headerPrefix="qjson-";class i{static qJsonExtractor(e){return i.qJsonExtractor2(e).qjson}static qJsonExtractor2(e){const t=i.qJsonMediumDecider(e);if(t.startsWith("qjson-")){let e=s(t.substring(6,t.indexOf("\n")));return{qjson:a[e].Parse(t),jsonString:t}}return{qjson:i.ParseQJsonContent(t),jsonString:t}}static qJsonMediumDecider(e){if("string"==typeof e)return e.startsWith('{"qjson":"')?JSON.parse(e).qjson:e;{const t=JSON.stringify(e);return e.qjson||t}}static ParseQJsonContent(e){return n.ParseQJsonContent(e)}}const a={v2:new o}},14182(e,t,r){r.d(t,{V:()=>s});const n=document.currentScript.src,o=n.substring(0,n.lastIndexOf("/"));class s{static getScriptRoot(){return o}static concatUrl(e,t){return(e.endsWith("/")?e:e+"/")+(t.startsWith("/")?t.substring(1):t)}}},74590(e,t,r){r.d(t,{B:()=>n});class n{isJsonString(e){try{JSON.parse(e)}catch(e){return!1}return!0}GetObjectType(e){return Object.prototype.toString.call(e)}isArray(e){return"[object Array]"==this.GetObjectType(e)}isString(e){return"[object String]"===this.GetObjectType(e)}isNumber(e){return"[object Number]"===this.GetObjectType(e)}isNull(e){return null==e}isFunction(e){return"[object Function]"===this.GetObjectType(e)}isObject(e){return"[object Object]"===this.GetObjectType(e)}isBool(e){return"[object Boolean]"===this.GetObjectType(e)}isBooleanConstructor(e){return"function Boolean() { [native code] }"==e?.toString()}isStringConstructor(e){return"function String() { [native code] }"==e?.toString()}isArrayConstructor(e){return"function Array() { [native code] }"==e?.toString()}isObjectConstructor(e){return"function Object() { [native code] }"==e?.toString()}isNumberConstructor(e){return"function Number() { [native code] }"==e?.toString()}isDateString(e){return!!this.isString(e)&&!isNaN(Date.parse(e))}isDate(e){return"[object Date]"===this.GetObjectType(e)}isFile(e){return"[object File]"===this.GetObjectType(e)}isBlob(e){return new Blob([e])instanceof Blob}cloneObject(e){var t;if(null==e||"object"!=typeof e)return e;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(Array.isArray(e)){t=[];for(var r=0,n=e.length;r<n;r++)t[r]=this.cloneObject(e[r]);return t}if("object"==typeof e){for(var o in t=e.constructor&&e.constructor.length<1?new e.constructor:{},e)e.hasOwnProperty(o)&&(t[o]=this.cloneObject(e[o]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}}},76501(e,t,r){r.d(t,{_:()=>o});var n=r(14182);class o{static getScriptRoot(){return n.V.getScriptRoot()}static concatUrl(e,t){return n.V.concatUrl(e,t)}static IsDirectUrl(e){return e.startsWith("http:")||e.startsWith("https:")||e.startsWith("blob:")}static GetDomain(e){let t;try{t=new URL(e)}catch(r){const n=document.createElement("a");n.href=e,t=n}return t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")}static ParseQuery(e){var t={};if(!e)return t;for(var r=("?"===e[0]?e.substr(1):e).split("&"),n=0;n<r.length;n++){var o=r[n].split("=");const e=decodeURIComponent(o[0]);let s=t[e];s||(s=[],t[e]=s),s.push(decodeURIComponent(o[1]||""))}return t}}},24227(e,t,r){r.d(t,{z:()=>s});var n=r(55049);const o="undefined";class s{constructor(){this.doc=typeof document!==o?document:{addEventListener(e,t,r){n.V.Log({logMessage:`Enviroment does not support document. Triggering document.addEventListener now, type is: ${e}`,logType:n.F.Warning}),t({target:{readyState:this.readyState}})},createElement:(e,t)=>({tagName:e,options:t}),readyState:"complete"},this.hist=typeof history!==o?history:{pushState(e,t,r){n.V.Log({logMessage:`history.pushState not supported on Node. title: ${t}`,logType:n.F.Debug})}},this.win=typeof window!==o?window:{setInterval,clearInterval,setTimeout,clearTimeout,atob,btoa},this.helperWorker={worker:(e,t)=>typeof Worker!==o?new Worker(e,t):void 0}}set onPopState(e){typeof window!==o?window.onpopstate=e:n.V.Log({logMessage:"onPopState not supported on Node.",logType:n.F.Debug})}get document(){return this.doc}get history(){return this.hist}get Window(){return this.win}get Worker(){return this.helperWorker}}s.Instance=class{static trySingularize(e,t,r){let n=t[e];return n||(n=t[e]=r),n}}.trySingularize("theOneWindow",(new s).Window,new s)},84308(e,t,r){r.d(t,{o:()=>n});class n{static getLang({self:e,ctrl:t,qJson:r,qLang:n}){return e||t?.O?.CL||r?.opt?.QL||n}}},20517(e,t,r){r.d(t,{K:()=>o});var n=r(76501);class o{static migrateLegacySettings(e){const t=(e,r,n)=>{1!=r.length?(n[r[0]]&&"object"!=typeof n[r[0]]&&(n[r[0]]={}),n[r[0]]=n[r[0]]||{},t(e,r.slice(1),n[r[0]])):n[r[0]]||(n[r[0]]=e)};return[{oldField:"csspath",newField:"cssPath",log:"legacy Settings.yaml. change csspath -> cssPath"},{oldField:"domainURL",newField:"qjsonURLPrefix",log:"legacy Settings.yaml. change domainURL -> qjsonURLPrefix"},{oldField:"urlprefix",newField:"qjsonURLPrefix",log:"legacy Settings.yaml. change urlprefix -> qjsonURLPrefix"},{oldField:"RegionalDefinition",newField:"regionalDefinition",log:"legacy Settings.yaml. change RegionalDefinition -> regionalDefinition"},{oldField:"DomainModuleList",newField:"domainModuleList",log:"legacy Settings.yaml. change DomainModuleList -> domainModuleList"},{oldField:"Backend",newField:"backendInf",log:"legacy Settings.yaml. Move Backend in to backendInf key."},{oldField:"PredefinedBackendHeaders",newField:"backendInf.PredefinedBackendHeaders",log:"legacy Settings.yaml. Move PredefinedBackendHeaders in to backendInf key."},{oldField:"HeaderExceptionList",newField:"backendInf.HeaderExceptionList",log:"legacy Settings.yaml. Move HeaderExceptionList in to backendInf key."},{oldField:"Header",newField:"backendInf.Header",log:"legacy Settings.yaml. Move Header in to backendInf key."},{oldField:"backendInf.singleTab",newField:"singleTab",log:"legacy Settings.yaml. Move Header in to backendInf key."},{oldField:"yamlLogType",newField:"appSettings.logging.yamlLogType",log:"legacy Settings.yaml. Move yamlLogType in to appSettings yamlLogType key."},{oldField:"minEngineLogLevel",newField:"appSettings.logging.minEngineLogLevel",log:"legacy Settings.yaml. Move minEngineLogLevel in to appSettings minEngineLogLevel key."},{oldField:"logBulkSize",newField:"appSettings.logging.logBulkSize",log:"legacy Settings.yaml. Move logBulkSize in to appSettings logBulkSize key."}].forEach(r=>{var n=(t=>{var r=t.split("."),n=e;for(let e=0;e<r.length;e++){var o=n[r[e]];if(!o)return;e==r.length-1&&delete n[r[e]],n=o}return n})(r.oldField);n&&t(n,r.newField.split("."),e)}),e}static fixLegacyPathFormat(e){if(e.startsWith("quick://")){var t=e.substring(8).split("/");return"/microui/"+t[0]+"/qjson/"+e.substring(t[0].length+9)}return e}static containerServicesModifications(e,t){return e||(e={}),t&&(e.logout=()=>{t.logout()},e.getPlateauIAM=()=>t),e}static fixQueryString(e){let t=window.location.search;const r=window.location.hash;let o={};t&&(t="?"===t[0]?t.substr(1):t,t=t.replace(/\?/,"&"),o=n._.ParseQuery(t),e=o.q?o.q.splice(0,1).join(""):e,0==o.q?.length&&delete o.q),o.qjsonpath&&(e+="?qjsonpath="+o.qjsonpath.splice(0,1),0==o.qjsonpath.length&&delete o.qjsonpath);const s=Object.entries(o).map(([e,t])=>t?.map(t=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).map(e=>e?.join("&")).join("&");if(e?.endsWith(".js"))return e;if(e){let t=e?.endsWith(".qjson")?e:e+=".qjson";return(s?t+"?"+s:t)+r}return e}}}},__webpack_module_cache__={},leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var r=Object.create(null);__webpack_require__.r(r);var n={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&t&&e;("object"==typeof o||"function"==typeof o)&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach(t=>n[t]=()=>e[t]);return n.default=()=>e,__webpack_require__.d(r,n),r},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce((t,r)=>(__webpack_require__.f[r](e,t),t),[])),__webpack_require__.u=e=>e+".js?ver=3.1.7-0",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="@stechquick/websdk:",__webpack_require__.l=(e,t,r,n)=>{if(inProgress[e])inProgress[e].push(t);else{var o,s;if(void 0!==r)for(var i=document.getElementsByTagName("script"),a=0;a<i.length;a++){var c=i[a];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==dataWebpackPrefix+r){o=c;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",dataWebpackPrefix+r),o.src=e),inProgress[e]=[t];var l=(t,r)=>{o.onerror=o.onload=null,clearTimeout(u);var n=inProgress[e];if(delete inProgress[e],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(e=>e(r)),t)return t(r)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=l.bind(null,o.onerror),o.onload=l.bind(null,o.onload),s&&document.head.appendChild(o)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="packages/websdk/",(()=>{__webpack_require__.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={4021:0};__webpack_require__.f.j=(t,r)=>{var n=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise((r,o)=>n=e[t]=[r,o]);r.push(n[2]=o);var s=__webpack_require__.p+__webpack_require__.u(t),i=new Error;__webpack_require__.l(s,r=>{if(__webpack_require__.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,n[1](i)}},"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[s,i,a]=r,c=0;if(s.some(t=>0!==e[t])){for(n in i)__webpack_require__.o(i,n)&&(__webpack_require__.m[n]=i[n]);a&&a(__webpack_require__)}for(t&&t(r);c<s.length;c++)o=s[c],__webpack_require__.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=this.webpackChunk_stechquick_websdk=this.webpackChunk_stechquick_websdk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var __webpack_exports__={};__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createRenderer:()=>createRenderer,destroy:()=>destroy,init:()=>init});var importHelper=__webpack_require__(93857),QJsonPool=__webpack_require__(75039),lazyLoader=__webpack_require__(17143),QJsonExtractHelper=__webpack_require__(72745),legacy=__webpack_require__(20517),PlateauMessaging=__webpack_require__(65654);class LivePreviewManager{constructor(){window.opener&&(this.frameCommunication=PlateauMessaging.Fl.CreatePlateauMessaging(window.opener))}async isItLivePreview(){if(!this.frameCommunication)return!1;try{const e=await this.frameCommunication.Send("LivePreview","getLPID",{type:"getLPID"},{awaitResponse:!0,awaitTime:100});return!(!e||"getLPIDResponse"!=e.msg.type)&&(this.livePreviewID=e.msg.ID,e.msg.ID)}catch{return!1}}async getLivePreviewSettings(){if(this.frameCommunication)try{const e=await this.frameCommunication.Send("LivePreview","getLPPlateauUIOptions",{type:"getLPPlateauUIOptions"},{awaitResponse:!0,awaitTime:1e4});if(!e||"getLPPlateauUIOptionsResponse"!=e.msg.type)return;return e.msg.PlateauUIOptions.serviceWorker||(this.getQjsonUrlPrefix=e.msg.getQJsonUrlPrefix),e.msg.PlateauUIOptions.settings.settings=e.msg.PlateauUIOptions.settings.settings||{value:{},type:"object"},e.msg.PlateauUIOptions.settings.settings.value.useLocalProxyOnClient=!0,e.msg.PlateauUIOptions}catch{return}}async sendSwMessage(e){if(this.frameCommunication)try{const t=await this.frameCommunication.Send("LivePreview","lpServiceWorkerRequestRequest",{type:"lpServiceWorkerRequestRequest",resourceId:e},{awaitResponse:!0,awaitTime:6e4});if(!t||"lpServiceWorkerRequestResponse"!=t.msg.type)return;return t.msg}catch{return}}setExternalQJsonRetriever(e){this.getQjsonUrlPrefix&&e.setQJsonUrlPrefix(this.getQjsonUrlPrefix)}}var logger=__webpack_require__(55049),websdkContainerInstance;class PlateauUI{constructor(e,t,r,n){this.container=e,this.renderer=t,this.mountPoint=r,this.sdkInstance=n}async open(e,t){this.sdkInstance.showCssTags(!0,t?.pageName),await this.container.open({renderer:this.renderer,qjsonPath:e,args:t})}show(e){this.renderer.resurrect();const t=e?.pageName||"default";this.sdkInstance.showCssTags(!0,t),this.mountPoint.style.display="block"}hide(e){const t=e?.pageName||"default";this.mountPoint.style.display="none",this.sdkInstance.showCssTags(!1,t),this.renderer.Hibernate(!0)}async close(e){await this.destroy(e)}async destroy(e){await this.renderer.settingModels.TriggerPipeline("applicationEnd",{});const t=e?.pageName||"default";this.sdkInstance.showCssTags(!1,t),this.sdkInstance.destroyRenderer(this.renderer),this.mountPoint.remove()}trigger({eventName:e,parameters:t}){return this.renderer.Trigger(e,t)}triggerPipeline({eventName:e,parameters:t}){return this.renderer.settingModels.TriggerPipeline(e,t)}getGlobalStore(e){const t=this.renderer.DoryInst.GetContext().GetItemSingle("GlobalStoreContext");if(!t)throw"Store context is not found";const r=t.get(e);return console.log("storeField => ",r),r}}class WebsdkContainer{constructor(){this.enviromentInfo="sdk",this.PlateauIAM=void 0,this.PlateauUIOptions={corsEnabled:!0,iam:"./settings/settings_iam.js",settings:"./settings/settings_web.js",asset:"./static/css/assetList.js"},this.initCompleted=!1,this.containerServicesParameter={},Object.defineProperty(this.containerServicesParameter,"plateauUIRenderer",{get(){throw new Error("Create renderer first!")},configurable:!0})}async init({PlateauUIOptions:e,environmentInfo:t="sdk"}){const r=this;r.enviromentInfo=t;var n=await r.configureLivePreview(e);if(r.PlateauUIOptions=n||(e??this.PlateauUIOptions),!r.settingsWeb){let e;if(r.lpManager)e=r.PlateauUIOptions.settings,r.appSettings=r.PlateauUIOptions.settings.appSettings?JSON.parse(r.PlateauUIOptions.settings.appSettings.value):void 0;else{const t=r.PlateauUIOptions.settings;if(e=t instanceof Promise?await t:await r.LoadJS(t,"plateauUISettings",{importField:"*"}),!e)throw"please set following: PlateauUIOptions['settings']"}e.localProxy&&"object"==e.localProxy.type&&(e.settings.value.settingsProxyYaml=e.settings.value.settingsProxyYaml||{},e.settings.value.settingsProxyYaml.localProxy=e.localProxy.value),r.SDKSettings=legacy.K.migrateLegacySettings(e.settings.value),r.lpManager&&(r.SDKSettings.appSettings=r.appSettings),r.settingsWeb=e}await r.handleIAMSettings(),r.assetList=n?.settings?.asset?.value;const o=r.PlateauUIOptions.asset;if(o)if(o instanceof Promise)try{r.assetList=await o}catch(e){}else r.assetList=await r.LoadJS(o,"plateauUIAsset",{importField:"*",required:!1});if(!this.SDKInstance){let e;r.settingsWeb?.containerServices&&(e=await r.LoadObject(r.settingsWeb.containerServices,"plateauUIContainerServices",{importField:"*",required:!1,parameters:this.containerServicesParameter})),e=legacy.K.containerServicesModifications(e,this.PlateauIAM),window.location.search&&(document.cookie="queryParams="+window.location.search+";path=/;"),this.SDKInstance=new((await Promise.all([__webpack_require__.e(5154),__webpack_require__.e(4664)]).then(__webpack_require__.bind(__webpack_require__,44030))).WebSDK)(r.SDKSettings,e,{environmentName:t})}if(r.lpManager&&r.lpManager.setExternalQJsonRetriever(r.SDKInstance),!r.SDKConfiguration){const e=await r.setSDKConfig();r.SDKConfiguration=e}this.initCompleted=!0}async createRenderer({mountPoint:e}){const t=this;this.initCompleted||await this.init({PlateauUIOptions:this.PlateauUIOptions,environmentInfo:this.enviromentInfo});const{newMountPoint:r,renderer:n}=this.SDKInstance.CreateRenderer({mountPoint:e,config:t.SDKConfiguration});n.DoryInst.SetAssetValues(t.assetList),await t.setSettingModels({renderer:n});var o=new PlateauUI(t,n,r,this.SDKInstance);return delete this.containerServicesParameter.plateauUIRenderer,this.containerServicesParameter.plateauUIRenderer=o,o}destroy(){this.SDKInstance?.destroy()}async initLoadingComponent(e){const t=this;if(!t.settingsWeb?.loading&&!t.settingsWeb?.settings.value.loadingqjson)return;if("lottie"==t.settingsWeb.loading?.format||"object"==t.settingsWeb.loading?.type)throw"Loading Lottie Format or Object Type on Web NOTIMPLEMENTED";let r;const n=e.getContextItem(QJsonPool.k.contextName),o=e.DoryInst,s=t.settingsWeb?.settings.value.loadingqjson;if(s&&(r={type:"path",path:s.startsWith("/")?s.substring(1):s,options:{disableLoading:!0}}),t.settingsWeb?.loading&&(r="js"==t.settingsWeb.loading.type?{type:"content",content:e.settingModels.GetLoadingQjson()}:{type:"path",path:t.settingsWeb.loading.value,options:{disableLoading:!0}}),(await n.retrieveAndFillQjsonAsync({qjson:r,dory:o})).changedPath)throw new Error("unexpected path change: possible masterPage")}async open({renderer:e,qjsonPath:t,args:r}){const n=this;let o;await n.initLoadingComponent(e);let s=legacy.K.fixQueryString();if("sdk"==this.enviromentInfo&&t)o={pjsonPath:t=legacy.K.fixLegacyPathFormat(t),storeItems:r};else if("qui"==this.enviromentInfo&&s)o={pjsonPath:s,storeItems:r};else if(!o&&n.settingsWeb?.rootqjson)o={pjsonContent:await n.LoadObject(n.settingsWeb?.rootqjson,""),pageName:n.settingsWeb.settings.value.rootqjson,storeItems:r};else{if(!n.settingsWeb?.settings.value.rootqjsonpath||n.settingsWeb.rootqjson)throw Error("please set following: PlateauUIOptions.rootqjson");{let e={format:"qjson",type:"js",value:await(this.SDKInstance?.qJsonRetriever.retrieveQJsonAsync(n.settingsWeb?.settings.value.rootqjsonpath,{disableLoading:!0}))};o={pjsonContent:await n.LoadObject(e,""),pjsonPath:n.settingsWeb.settings.value.rootqjsonpath}}}o.pjsonPath?.includes("<<qjsonpass:")&&(o.pjsonPath=o.pjsonPath.replace("<<qjsonpass:","<<qjson:").replace(".qjson",""));const i=e.Render(o),a=this.SDKInstance?.getUXManager();a?.setTheme("default",this.settingsWeb?.style),await i}async handleIAMSettings(){const e=this;if(e.PlateauUIOptions.iam){const r=e.PlateauUIOptions.iam;e.lpManager&&(r.iamV2=e.appSettings?.oAuthSettings);var t=e.lpManager?r:r instanceof Promise?await r:await e.LoadJS(r,"plateauUIIAMOptions",{importField:"*",required:!1});if(t&&t.iam?.active||t?.iamV2?.active){e.PlateauIAM=new((await Promise.all([__webpack_require__.e(151),__webpack_require__.e(994)]).then(__webpack_require__.bind(__webpack_require__,40399))).PlateauIAM),e.PlateauIAM.setOptions({iam:t.iam,iamV2:t.iamV2}),e.PlateauIAM.settingsIAM=t;let r=!0,n=e.settingsWeb?.settings.value.rootqjson??e.settingsWeb?.settings.value.rootqjsonpath,o=e.PlateauIAM.settingsIAM.iamV2?.unsecurePages??e.PlateauIAM.settingsIAM?.iam?.unsecurePages;if(o)for(let e=0;e<o.length;e++){let t=legacy.K.fixQueryString();o[e]===(t??n)&&(r=!1)}if(r&&(await e.PlateauIAM.login(e.PlateauUIOptions),!e.PlateauIAM.isAuthenticated()))throw Error("Authentication: Must logon")}}}async setSDKConfig(){var e,t,r=this;r.settingsWeb?.componentList&&(e=r.LoadObject(r.settingsWeb.componentList,"plateauUIComponentOptions",{importField:"*",required:!1})),r.settingsWeb?.globalLocalization&&(t=r.LoadObject(r.settingsWeb?.globalLocalization,"",{importField:"*",required:!1}),r.LoadQjson(r.settingsWeb?.globalLocalization));var n={};return Promise.all([e,t]).then(([e,t])=>(e&&(n.SiteSettings={compSettings:e}),t&&(n.GlobalLRDict=t.clrids),r.SDKSettings?.rootLangCode&&(n.LRType=r.SDKSettings?.rootLangCode),r.SDKSettings?.configValues&&(n.configValues=r.SDKSettings?.configValues),r.PlateauUIOptions?.shadowDomOptions&&(n.shadowDomOptions=r.PlateauUIOptions?.shadowDomOptions),n))}async setSettingModels({renderer:e}){var t=this;const r=t.settingsWeb?.settings.value.pipelineqjson,n=t.settingsWeb?.settings.value.alertqjson,o=t.settingsWeb?.settings.value.loadingqjson;let s=t.settingsWeb?.pipeline||{type:"path",value:r?.startsWith("/")?r.substring(1):r,format:"qjson"};if(s&&s.value){const r=await t.LoadObject(s,"",{importField:"*",required:!1});if(r)try{await e.settingModels.SetPipelineQjson(r)}catch(e){}}let i=t.settingsWeb?.alert||{type:"path",value:n?.startsWith("/")?n.substring(1):n,format:"qjson"};if(i&&i.value){const r=await t.LoadObject(i,"",{importField:"*",required:!1});if(r)try{await e.settingModels.SetAlertQjson(r)}catch(e){}}let a=t.settingsWeb?.loading||{type:"path",value:o?.startsWith("/")?o.substring(1):o,format:"qjson"};if(a&&a.value){const r=await t.LoadObject(a,"",{importField:"*",required:!1});if(r)try{await e.settingModels.SetLoadingQjson(r)}catch(e){}}t.SDKSettings?.domainModuleList&&await(t.SDKInstance?.LoadModuleCompLists(t.SDKSettings.domainModuleList).catch(e=>{logger.V.Log({logMessage:e,logType:logger.F.Error})}))}async LoadObject(e,t,r={required:!0}){const n=this;if(e){if(r.parameters&&"path"!=e.type&&"js"!=e.type){if("object"!=e.type)throw new Error("Parameters can be used for 'path' and 'js' data types!");logger.V.Log({logMessage:"LoadObject with object type not supported with parameters.",logType:logger.F.Warning})}if("qjson"==e.format)return await n.LoadQjson(e);if("lottie"==e.format)throw new Error("Not implemented");return"path"==e.type?await n.LoadJS(e.value,t,r):"object"==e.type?e.value:"js"==e.type?await(0,importHelper.importModuleBody)(e.value,()=>{},r.importField,r.parameters):void 0}}async LoadJS(e,t,r={required:!0}){try{if(this.PlateauUIOptions.corsEnabled&&"string"==typeof e)return await(0,importHelper.importScript)(e,t,r.importField,r.parameters);{let t="string"==typeof e?e:new Request(e.url,{method:"GET",body:JSON.stringify(e.body),headers:e.headers});return await(0,importHelper.importModule)(t,()=>{},r.importField,r.parameters)}}catch(t){if(!r.required)return;throw new Error("couldn't load "+JSON.stringify(e))}}async LoadQjson(e){let t="";if("path"==e.type){var r=legacy.K.fixLegacyPathFormat(e.value);t=(await lazyLoader.w.FetchModuleBody(r)).body}if("js"==e.type&&(t=e.value),!t)return;const n=QJsonExtractHelper.x.qJsonExtractor(t);if(!n)throw new Error("qJsonExtracted is undefined");return n}async configureLivePreview(e){if(!e?.disableLP){var t=new LivePreviewManager;if(await t.isItLivePreview()){this.lpManager=t;var r=await t.getLivePreviewSettings();if(logger.V.Log({logMessage:`settingsResponse: ${r}`}),r)return r.serviceWorker&&this.registerServiceWorker(),r}}}getBuildVersion(){try{return"3.1.7-0"}catch{return"0.0.0"}}async registerServiceWorker(){var e=this,t="./sw.js?ver="+this.getBuildVersion();if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register(t,{scope:"/qui-lp/"});e.installing?logger.V.Log({logMessage:"Service worker installing"}):e.waiting?logger.V.Log({logMessage:"Service worker installed"}):e.active&&logger.V.Log({logMessage:"Service worker activated"})}catch(e){logger.V.Log({logMessage:`Registration failed with ${e}`,logType:logger.F.Error})}navigator.serviceWorker.onmessage=t=>{const r=t.data;e.onSWMessage(r)}}async onSWMessage(e){const t=await this.lpManager.sendSwMessage(e);this.sendMessage(t)}sendMessage(e){setTimeout(()=>{navigator.serviceWorker.controller?.postMessage(e)},1e3)}}async function init(e,t){return websdkContainerInstance||(websdkContainerInstance=new WebsdkContainer,await websdkContainerInstance.init({PlateauUIOptions:e,environmentInfo:t}),websdkContainerInstance)}function createRenderer({mountPoint:e}){if(!websdkContainerInstance)throw"websdk initiation went wrong.";return websdkContainerInstance.createRenderer({mountPoint:e})}function destroy(){websdkContainerInstance&&(websdkContainerInstance.destroy(),websdkContainerInstance=void 0)}return __webpack_exports__})());