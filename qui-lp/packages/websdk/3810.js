(this.webpackChunk_stechquick_websdk=this.webpackChunk_stechquick_websdk||[]).push([[3810],{60118:(t,e,i)=>{"use strict";i.d(e,{C:()=>s,X:()=>r});var n=!1;new Promise((function(t){return t()})).then((function(){return n=!0})),"undefined"!=typeof doNothing&&doNothing();var o=!0===n;function r(t,e){void 0===e&&(e={});var i,n=void 0,r=void 0,s=function(t){i&&clearTimeout(i),i=setTimeout((function(){r(new Error("The operation has timed out. timeoutValue  : "+t))}),t)},a=!1,u=!1,l=function(){return a||u};return t&&s(t),{startTimer:s,promise:new Promise((function(t,i){var s=function(t){return o&&e.fixSyncResolve?function(e){return setTimeout((function(){return t(e)}))}:t}(t);n=function(t){l()||(a=!0,s(t))},r=function(t){l()||(u=!0,i(t))}})),resolver:n,reject:r,isResolved:function(){return a},isRejected:function(){return u},isCompleted:l}}function s(t){var e=this,i=r(),n=t.length;return t.forEach((function(t){return o=e,s=function(){return function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return e.trys.push([0,,2,3]),[4,t];case 1:return e.sent(),[3,3];case 2:return--n<=0&&i.resolver(t),[7];case 3:return[2]}}))},new((r=void 0)||(r=Promise))((function(t,e){function i(t){try{a(s.next(t))}catch(t){e(t)}}function n(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var o;e.done?t(e.value):(o=e.value,o instanceof r?o:new r((function(t){t(o)}))).then(i,n)}a((s=s.apply(o,[])).next())}));var o,r,s})),i.promise}},90445:(t,e,i)=>{"use strict";i.r(e),i.d(e,{PlateauIAM:()=>g});var n=i(64e3),o=i(36348),r=i(62190),s=i(60118);function a(t,e){t.postMessage(e,"*")}var u,l=function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{u(n.next(t))}catch(t){r(t)}}function a(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))},c=function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},h=function(){function t(t){void 0===t&&(t=r.Y),this.logger=t,this.sessionStorageNamePrefix="",this.preserveTokens=!1}return t.prototype.initAndLogin=function(t,e){var i,o,r,s,a,u,h,d,p,f,v;return l(this,void 0,void 0,(function(){var l,k,y,m,g,w;return c(this,(function(c){switch(c.label){case 0:return this.sessionStorageNamePrefix=null!==(i=e.sessionStorageNamePrefix)&&void 0!==i?i:"",this.preserveTokens=!!e.preserveTokens,this.keycloak=(0,n.Z)({url:e.url,realm:null!==(o=e.realm)&&void 0!==o?o:void 0,clientId:e.clientId}),l={onLoad:null!==(r=e.onLoad)&&void 0!==r?r:"login-required",pkceMethod:"S256",checkLoginIframe:!1,responseMode:null!==(s=e.responseMode)&&void 0!==s?s:"fragment",redirectUri:null!==(a=e.redirectUri)&&void 0!==a?a:void 0},k={locale:null!==(u=e.language)&&void 0!==u?u:void 0,redirectUri:null!==(h=e.redirectUri)&&void 0!==h?h:void 0},this.preserveTokens&&(null==(y=this.getTokens(this.sessionStorageNamePrefix))?void 0:y.idToken)&&(null==y?void 0:y.refreshToken)&&(null==y?void 0:y.token)&&(l.idToken=y.idToken,l.refreshToken=y.refreshToken,l.token=y.token),m=!(!(null!==(d=null==t?void 0:t.iamWithPopup)&&void 0!==d?d:e.popup)||(null==t?void 0:t.iamInPopup)),(null==t?void 0:t.iamInPopup)?(this.handleInPopup(),[2]):(g=!1,m?[4,this.handleIAMPopup(t,l)]:[3,2]);case 1:return g=c.sent(),[3,5];case 2:return[4,this.keycloak.init(l)];case 3:return(g=c.sent())?[3,5]:[4,this.keycloak.login(k)];case 4:return c.sent(),[2];case 5:if(this.preserveTokens&&(w=this.getTokenFromKeycloak())&&this.setTokens(this.sessionStorageNamePrefix,w),"boolean"==typeof g){if(g)return window.location.search&&(document.cookie="queryParamsIAM="+window.location.search+";path=/;"),[2,{token:null===(p=this.keycloak)||void 0===p?void 0:p.token,info:null!==(v=null===(f=this.keycloak)||void 0===f?void 0:f.tokenParsed)&&void 0!==v?v:{}}];window.location.reload()}return[2]}}))}))},t.prototype.refresh=function(t,e,i){return l(this,void 0,void 0,(function(){var n,o;return c(this,(function(r){switch(r.label){case 0:if(!this.keycloak)return[2,!1];n=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.keycloak.updateToken(t)];case 2:return n=r.sent(),i&&(o=this.getTokenFromKeycloak())&&this.setTokens(e,o),[3,4];case 3:return r.sent(),window.location.href=window.location.protocol+"//"+window.location.host,[3,4];case 4:return[2,n]}}))}))},t.prototype.logout=function(t){return l(this,void 0,void 0,(function(){var e,i,n,o;return c(this,(function(r){switch(r.label){case 0:return this.keycloak?(e=t(),i={redirectUri:e},n=this.keycloak.createLogoutUrl(i),o={redirectUri:n},[4,this.keycloak.logout(o)]):[2];case 1:return r.sent(),[2]}}))}))},t.prototype.isAuthenticated=function(){var t;return!!(null===(t=this.keycloak)||void 0===t?void 0:t.authenticated)},t.prototype.getSession=function(){var t,e;return(null===(t=this.keycloak)||void 0===t?void 0:t.token)?{token:this.keycloak.token,info:null!==(e=this.keycloak.tokenParsed)&&void 0!==e?e:{}}:{}},t.prototype.handleIAMPopup=function(t,e){return l(this,void 0,void 0,(function(){var i,n,r,u,h,d,p,f,v,k=this;return c(this,(function(y){switch(y.label){case 0:if(!this.keycloak)throw new Error("[Keycloak] instance not initialized");if(n=(0,s.X)(),r=function(t){var e={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n&&null!==n||(e[i]=n)}return e},u=o.t.concatUrl(o.t.getScriptRoot(),"../assets/oidc.html"),!(h=window.open(u,"plateauIAMPopup","popup")))throw d="Failed to open new window.",console.error(d),new Error(d);return i=setInterval((function(){if(h.closed){clearInterval(i);var t="popup window closed before authentication";console.error(t),n.reject(new Error(t))}}),500),p=function(e){return l(k,void 0,void 0,(function(){var o,s;return c(this,(function(u){if(e.source!==h)return[2];switch(e.data.type){case"setTokens":return window.removeEventListener("message",p),clearInterval(i),n.resolver(e.data.tokenInfo),[2];case"iamReady":return o=r(window),s=this.getTokens(this.sessionStorageNamePrefix),a(h,{type:"iamOptions",options:t,tokens:s,sessionStorageNamePrefix:this.sessionStorageNamePrefix,parentWindow:o}),[2]}return[2]}))}))},window.addEventListener("message",p),[4,n.promise.catch((function(t){try{window.removeEventListener("message",p)}catch(t){}try{clearInterval(i)}catch(t){}throw t}))];case 1:return f=y.sent(),this.setToOptions(e,f),[4,this.keycloak.init(e)];case 2:return v=y.sent(),this.preserveTokens&&f&&this.setTokens(this.sessionStorageNamePrefix,f),[2,v]}}))}))},t.prototype.handleInPopup=function(){var t=this.getTokenFromKeycloak();if(!t)throw new Error("could not retrieve tokenInfo from keycloak");a(opener,{type:"setTokens",tokenInfo:t}),window.close()},t.prototype.getTokenFromKeycloak=function(){if(this.keycloak&&this.keycloak.idToken&&this.keycloak.refreshToken&&this.keycloak.token)return{idToken:this.keycloak.idToken,refreshToken:this.keycloak.refreshToken,token:this.keycloak.token,info:this.keycloak.tokenParsed}},t.prototype.setToOptions=function(t,e){t.idToken=e.idToken,t.refreshToken=e.refreshToken,t.token=e.token},t.prototype.setTokens=function(t,e){e&&(e.idToken&&sessionStorage.setItem(t+"kcIdToken",e.idToken),e.refreshToken&&sessionStorage.setItem(t+"kcRefreshToken",e.refreshToken),e.token&&sessionStorage.setItem(t+"kcToken",e.token))},t.prototype.getTokens=function(t){var e,i,n;return{idToken:null!==(e=sessionStorage.getItem(t+"kcIdToken"))&&void 0!==e?e:void 0,refreshToken:null!==(i=sessionStorage.getItem(t+"kcRefreshToken"))&&void 0!==i?i:void 0,token:null!==(n=sessionStorage.getItem(t+"kcToken"))&&void 0!==n?n:void 0}},t}(),d=i(66749),p=function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{u(n.next(t))}catch(t){r(t)}}function a(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))},f=function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},v=function(){function t(){this.user=null,this.authOptions={},this.initOptions={},this.userManager=new d.ws({authority:"http://identity-provider.product-plateau-security-int.plateausecurity.plateaux.softtech/auth/realms/Web",client_id:"ui-web-client",redirect_uri:"http://localhost:3002/",response_type:"code",monitorSession:!1,userStore:new d.bA({store:window.localStorage})})}return t.prototype.configure=function(t,e){this.authOptions=null!=t?t:{},this.initOptions=null!=e?e:{}},t.prototype.isAuthenticated=function(){return!!this.user&&!this.user.expired},t.prototype.init=function(){return p(this,void 0,void 0,(function(){var t,e,i,n,o,r,s,a;return f(this,(function(u){switch(u.label){case 0:return t=this.authOptions.active?this.authOptions:this.initOptions,e=this.joinAuthority(t.url,t.realm),i=t.clientId,n=t.redirectUri||window.location.href,this.userManager=new d.ws({authority:e,client_id:i,redirect_uri:n,response_type:"code",monitorSession:!1,userStore:new d.bA({store:window.localStorage})}),o=this,[4,this.userManager.getUser()];case 1:if(o.user=u.sent(),r=new URLSearchParams(window.location.search),this.user||!r.has("code")||!r.has("state"))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),s=this,[4,this.userManager.signinRedirectCallback()];case 3:return s.user=u.sent(),window.history.replaceState({},document.title,window.location.pathname),window.location.href="/",[2];case 4:throw a=u.sent(),console.error("OIDC redirect handling failed:",a),a;case 5:return this.user?[3,7]:[4,this.userManager.signinRedirect()];case 6:return u.sent(),[2];case 7:return this.setTokens(),[2]}}))}))},t.prototype.login=function(){return p(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.init()];case 1:return t.sent(),[2]}}))}))},t.prototype.getSession=function(){var t;return!this.user||this.user.expired?{}:{token:this.user.access_token,info:null!==(t=this.user.profile)&&void 0!==t?t:{}}},t.prototype.getTokens=function(){if(this.user)return{idToken:this.user.id_token,refreshToken:this.user.refresh_token,token:this.user.access_token}},t.prototype.setTokens=function(){var t;if(this.user){localStorage.setItem("access_token",null!==(t=this.user.access_token)&&void 0!==t?t:""),this.user.id_token&&localStorage.setItem("id_token",this.user.id_token);var e=this.user.refresh_token;e&&localStorage.setItem("refresh_token",e)}},t.prototype.logout=function(){return p(this,void 0,void 0,(function(){var t,e,i;return f(this,(function(n){switch(n.label){case 0:return t=window.location.protocol+"//"+window.location.host,e=this.getLogoutURLParams(),i=this.getRedirectURL(e,t),this.userManager?[4,this.userManager.signoutRedirect({post_logout_redirect_uri:i})]:[3,2];case 1:return n.sent(),[3,3];case 2:window.location.href=i,n.label=3;case 3:return[2]}}))}))},t.prototype.getRedirectURL=function(t,e){var i=e;return t.forEach((function(t){var e;if(t.value){var n=i.includes("?")?"&":"?";i+=""+n+t.key+"="+encodeURIComponent(null!==(e=t.value)&&void 0!==e?e:"")}})),i},t.prototype.getLogoutURLParams=function(){var t=this.authOptions.active?this.authOptions:this.initOptions,e=this.authOptions.active?this.authOptions.language:this.initOptions.locale;return[{key:"realm",value:t.realm},{key:"subdomain",value:t.subdomain},{key:"lang",value:e}]},t.prototype.joinAuthority=function(t,e){return(null!=t?t:"").replace(/\/+$/,"")+"/realms/"+(null!=e?e:"").replace(/^\/+/,"")},t}(),k=function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{u(n.next(t))}catch(t){r(t)}}function a(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))},y=function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},m=["https://","http://"];!function(t){t.oidcClient="oidc-client",t.keycloak="keycloak"}(u||(u={}));var g=function(){function t(){var t=this;this.refreshTime=6e3,this.updateTime=10,this.initOptions={url:"http://identity-provider.dev.rally.softtech/auth/",realm:"main",clientId:"ui-web-client",onLoad:"login-required",pkceMethod:"S256",identityProvider:"",locale:""},this.authOptions={url:"",active:!1},this.provider=u.oidcClient,this.iamPlateau=void 0,this.sessionStorageNamePrefix="",this.getToken=function(){var e;return null===(e=t.iamPlateau)||void 0===e?void 0:e.token},this.getInfo=function(){var e;return null===(e=t.iamPlateau)||void 0===e?void 0:e.info}}return t.prototype.init=function(t){var e,i,n,o,r,s,a,l,c,d,p,f,m,g,w,b,O,P,T,S,I;return k(this,void 0,void 0,(function(){var k,A,x,L,U;return y(this,(function(y){switch(y.label){case 0:return this.decideProvider(),this.sessionStorageNamePrefix=(null===(n=null===(i=null===(e=this.settingsIAM)||void 0===e?void 0:e.iam)||void 0===i?void 0:i.options)||void 0===n?void 0:n.sessionStorageNamePrefix)||this.authOptions.sessionStorageNamePrefix?((null===(s=null===(r=null===(o=this.settingsIAM)||void 0===o?void 0:o.iam)||void 0===r?void 0:r.options)||void 0===s?void 0:s.sessionStorageNamePrefix)||this.authOptions.sessionStorageNamePrefix)+"_":"",k=this.authOptions.active?this.authOptions.redirectUri:this.initOptions.redirectUri,A=this.setQueryOrFragment(new URL(window.location.href),k),this.provider!==u.oidcClient?[3,2]:(this.oidcClientAuth||(this.oidcClientAuth=new v),this.oidcClientAuth.configure({url:this.authOptions.url,realm:null!==(a=this.authOptions.realm)&&void 0!==a?a:void 0,clientId:null!==(l=this.authOptions.clientId)&&void 0!==l?l:this.initOptions.clientId,redirectUri:null!==(c=null!=A?A:this.authOptions.redirectUri)&&void 0!==c?c:window.location.href,language:null!==(p=null!==(d=this.authOptions.language)&&void 0!==d?d:this.initOptions.locale)&&void 0!==p?p:null,subdomain:null!==(m=null!==(f=this.authOptions.subdomain)&&void 0!==f?f:this.initOptions.subdomain)&&void 0!==m?m:null,active:this.authOptions.active},this.initOptions),[4,this.oidcClientAuth.login()]);case 1:return y.sent(),(null==(x=this.oidcClientAuth.getSession())?void 0:x.token)&&(this.iamPlateau={token:x.token,info:null!==(g=x.info)&&void 0!==g?g:{}},window.location.search&&(document.cookie="queryParamsIAM="+window.location.search+";path=/;")),[2];case 2:return this.keycloakAuth||(this.keycloakAuth=new h),L={url:this.authOptions.active?this.authOptions.url:this.initOptions.url,realm:null!==(w=this.authOptions.active?this.authOptions.realm:this.initOptions.realm)&&void 0!==w?w:null,clientId:this.authOptions.active?this.authOptions.clientId:this.initOptions.clientId,onLoad:this.authOptions.active?"login-required":this.initOptions.onLoad,responseMode:this.authOptions.active?"fragment":this.initOptions.responseMode,language:null!==(O=null!==(b=this.authOptions.language)&&void 0!==b?b:this.initOptions.locale)&&void 0!==O?O:null,popup:this.authOptions.popup,sessionStorageNamePrefix:this.sessionStorageNamePrefix,preserveTokens:this.authOptions.preserveTokens||(null===(S=null===(T=null===(P=this.settingsIAM)||void 0===P?void 0:P.iam)||void 0===T?void 0:T.options)||void 0===S?void 0:S.preserveTokens),redirectUri:null!==(I=null!=A?A:this.authOptions.redirectUri)&&void 0!==I?I:this.initOptions.redirectUri},[4,this.keycloakAuth.initAndLogin(t,L)];case 3:return(U=y.sent())&&(this.iamPlateau={token:U.token,info:U.info}),[2]}}))}))},t.prototype.refreshPromise=function(){var t,e,i,n,o;return k(this,void 0,void 0,(function(){var r,s;return y(this,(function(a){switch(a.label){case 0:return this.provider===u.oidcClient&&this.oidcClientAuth?[4,null===(e=(t=this.oidcClientAuth).refresh)||void 0===e?void 0:e.call(t)]:[3,2];case 1:return(r=a.sent())&&(s=this.oidcClientAuth.getSession(),this.iamPlateau={token:s.token,info:s.info}),[2,r];case 2:return this.provider===u.keycloak&&this.keycloakAuth?[4,this.keycloakAuth.refresh(this.updateTime,this.sessionStorageNamePrefix,this.authOptions.preserveTokens||(null===(o=null===(n=null===(i=this.settingsIAM)||void 0===i?void 0:i.iam)||void 0===n?void 0:n.options)||void 0===o?void 0:o.preserveTokens))]:[3,4];case 3:return(r=a.sent())&&(s=this.keycloakAuth.getSession(),this.iamPlateau={token:s.token,info:s.info}),[2,r];case 4:return[2,void 0]}}))}))},t.prototype.logout=function(){this.doLogout()},t.prototype.doLogout=function(){return k(this,void 0,void 0,(function(){var t=this;return y(this,(function(e){switch(e.label){case 0:return this.provider===u.oidcClient&&this.oidcClientAuth?[4,this.oidcClientAuth.logout()]:[3,2];case 1:case 3:return e.sent(),this.iamPlateau=void 0,[2];case 2:return this.provider===u.keycloak&&this.keycloakAuth?[4,this.keycloakAuth.logout((function(){return t.buildLogoutRedirectUrl()}))]:[3,4];case 4:return[2]}}))}))},t.prototype.setOptions=function(t){var e=t.iam,i=t.iamV2;if(null==i?void 0:i.active)this.configureNewOAuthSettings(i);else try{var n=null==e?void 0:e.options;if(!n)throw new Error("iam in settings is missing options");if(null!=n.identityProvider)if("object"==typeof n.identityProvider){var o="",r=n.url.split("."),s=2;try{(s=parseInt(n.identityProvider.order))<=0&&(s=2)}catch(t){s=2}if("queryString"===n.identityProvider.type){var a=new URLSearchParams(window.location.search);if(null!=a.get("subdomain")&&(o=a.get("subdomain"),r[s-1]=o,this.initOptions.subdomain=o),null!=a.get("realm"))n.realm=a.get("realm"),n.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+n.realm+";path=/;");else if(!n.sessionStorageNamePrefix){var u=this.getItemFromCookies("queryParamsRealmIAM");u&&(n.realm=u)}var l=n.localeQueryStringKey||"ui_locales";if(null!=a.get(l))this.initOptions.locale=a.get(l),n.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+this.initOptions.locale+";path=/;");else if(this.initOptions.locale=void 0,!n.sessionStorageNamePrefix){var c=this.getItemFromCookies("queryParamsLocaleIAM");c&&(this.initOptions.locale=c)}}else"subdomain"===n.identityProvider.type&&(o=window.location.host.split(".")[0],r[s-1]=o);n.url=r.join(".")}else n.identityProvider.length>1&&(n.url=window.location.protocol+"//"+window.location.host.replace(n.identityProvider,"identity-provider")+"/auth");n.url&&(this.initOptions.url=n.url),n.realm&&(this.initOptions.realm=n.realm),n.clientId&&(this.initOptions.clientId=n.clientId),n.onLoad&&(this.initOptions.onLoad=n.onLoad),n.pkceMethod&&(this.initOptions.pkceMethod=n.pkceMethod),n.identityProvider&&(this.initOptions.identityProvider=n.identityProvider),n.redirectUri&&(this.initOptions.redirectUri=n.redirectUri),n.responseMode&&(this.initOptions.responseMode=n.responseMode),n.preserveTokens&&(this.initOptions.preserveTokens=n.preserveTokens),this.authOptions.url=this.initOptions.url||this.authOptions.url,this.authOptions.realm=this.initOptions.realm||this.authOptions.realm,this.authOptions.clientId=this.initOptions.clientId||this.authOptions.clientId,this.authOptions.redirectUri=this.initOptions.redirectUri||this.authOptions.redirectUri,this.authOptions.authority=this.computeAuthority(this.authOptions.url,this.authOptions.realm)}catch(t){var h=t.message||"error has no message";console.error("Error on setting IAM options:",h)}},t.prototype.isAuthenticated=function(){var t;return this.provider===u.oidcClient&&this.oidcClientAuth?this.oidcClientAuth.isAuthenticated():this.provider===u.keycloak&&this.keycloakAuth?this.keycloakAuth.isAuthenticated():!!(null===(t=this.iamPlateau)||void 0===t?void 0:t.token)},t.prototype.decideProvider=function(){var t,e,i,n=null!==(i=null===(e=null===(t=this.settingsIAM)||void 0===t?void 0:t.iam)||void 0===e?void 0:e.iamAuth)&&void 0!==i?i:this.authOptions.iamAuth;this.provider=n===u.oidcClient?u.oidcClient:u.keycloak},t.prototype.getItemFromCookies=function(t){var e,i,n=document.cookie.split(";");try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),r=o.next();!r.done;r=o.next()){var s=r.value,a=s.indexOf("=");if(-1!==a&&s.substring(0,a).trim()===t){var u=s.substring(a+1);return decodeURIComponent(u)}}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t.prototype.configureNewOAuthSettings=function(t){this.authOptions.active=t.active;var e=t.idendityProviderURL||"",i=new URLSearchParams(window.location.search);this.authOptions.subdomain=this.getSubdomain(t,i),e=this.replaceSubdomain(e,this.authOptions),this.authOptions.realm=this.getRealm(t,i),this.authOptions.language=this.getLocale(t,i),this.authOptions.url=e,this.authOptions.clientId=t.clientId,this.authOptions.preserveTokens=t.preserveTokens,this.authOptions.redirectUri=t.redirectUri,this.authOptions.onLoad=t.onLoad,this.authOptions.popup=t.popup,this.authOptions.sessionStorageNamePrefix=t.sessionStorageNamePrefix,this.authOptions.iamAuth=t.iamAuth,this.authOptions.authority=this.computeAuthority(this.authOptions.url,this.authOptions.realm)},t.prototype.getLocale=function(t,e){return t.isLangFromQS?e.get("lang"):t.language},t.prototype.replaceSubdomain=function(t,e){var i=t.split(".");return i[1]=e.subdomain||i[1],i.join(".")},t.prototype.getRealm=function(t,e){return t.isRealmFromQS?e.get("realm"):t.realm},t.prototype.getSubdomain=function(t,e){var i="";switch(t.subdomainSource){case"constant":i=t.subdomainValue;break;case"query":i=e.get("subdomain");break;case"currentDomain":i=window.location.host.split(".")[0]}return i},t.prototype.computeAuthority=function(t,e){if(t&&e)return t.replace(/\/+$/,"")+"/realms/"+e},t.prototype.buildLogoutRedirectUrl=function(){var t=window.location.protocol+"//"+window.location.host,e=this.getLogoutURLParams();return this.getRedirectURL(e,t)},t.prototype.getRedirectURL=function(t,e){var i;return(this.authOptions.active||"queryString"===(null===(i=this.initOptions.identityProvider)||void 0===i?void 0:i.type))&&t.reduce((function(t,i){if(!i.value)return t;var n=e.includes("?")?"&":"?";return e=e+n+(i.key+"=")+i.value}),""),e},t.prototype.getLogoutURLParams=function(){var t=this.authOptions.active?this.authOptions:this.initOptions,e=this.authOptions.active?this.authOptions.language:this.initOptions.locale;return[{key:"realm",value:t.realm},{key:"subdomain",value:t.subdomain},{key:"lang",value:e}]},t.prototype.setQueryOrFragment=function(t,e){if(e){if(null!=m.find((function(t){return e.startsWith(t)})))return e;var i=new URL("http://a.com/"+e),n="/"==t.pathname?"":t.pathname,o="/"==i.pathname?"":i.pathname,r=n&&o?o.startsWith("//")?o.substring(1):this.pathJoin(n,o):n||o,s=t.search&&i.search?t.search+i.search.replace("?","&"):t.search||i.search,a=t.hash&&i.hash?t.hash+i.hash.replace("#","&"):t.hash||i.hash;return t.origin+r+s+a}},t.prototype.pathJoin=function(t,e){return(t=t.endsWith("/")?t.substring(0,t.length-1):t)+"/"+(e.startsWith("/")?e.substring(1):e)},t.prototype.login=function(t){return k(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,this.init(t)];case 1:return e.sent(),[2]}}))}))},t}()},50633:()=>{}}]);