(this.webpackChunk_stechquick_websdk=this.webpackChunk_stechquick_websdk||[]).push([[994],{25156(){},40399(e,t,i){"use strict";i.r(t),i.d(t,{PlateauIAM:()=>p});var s=i(43905),o=i(14182),n=i(55049),a=i(77059);function r(e,t){e.postMessage(t,"*")}const h=["https://","http://"];class l{constructor(){this.refreshTime=6e3,this.updateTime=10,this.initOptions={url:"http://identity-provider.dev.rally.softtech/auth/",realm:"main",clientId:"ui-web-client",onLoad:"login-required",pkceMethod:"S256",identityProvider:"",locale:""},this.authOptions={url:"",active:!1},this.iamPlateau=void 0,this.sessionStorageNamePrefix="",this.getToken=()=>null!=this.iamPlateau?this.iamPlateau.token:void 0,this.getInfo=()=>null!=this.iamPlateau?this.iamPlateau.info:void 0}setOptions({iam:e,iamV2:t}){if(this.settingsIAM={iam:e,iamV2:t},t?.active)this.configureNewOAuthSettings(t);else try{const t=e?.options;if(!t)throw new Error("iam in settings is missing options");if(null!=t.identityProvider)if("object"==typeof t.identityProvider){var i="",s=t.url.split("."),o=2;try{(o=parseInt(t.identityProvider.order))<=0&&(o=2)}catch(e){o=2}if("queryString"===t.identityProvider.type){var a=new URLSearchParams(window.location.search);if(null!=a.get("subdomain")&&(i=a.get("subdomain"),s[o-1]=i,this.initOptions.subdomain=i),null!=a.get("realm"))t.realm=a.get("realm"),t.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+t.realm+";path=/;");else if(!t.sessionStorageNamePrefix){let e=this.getItemFromCookies("queryParamsRealmIAM");e&&(t.realm=e)}const e=t.localeQueryStringKey||"ui_locales";if(null!=a.get(e))this.initOptions.locale=a.get(e),t.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+this.initOptions.locale+";path=/;");else if(this.initOptions.locale=void 0,!t.sessionStorageNamePrefix){let e=this.getItemFromCookies("queryParamsLocaleIAM");e&&(this.initOptions.locale=e)}}else"subdomain"===t.identityProvider.type&&(i=window.location.host.split(".")[0],s[o-1]=i);t.url=s.join(".")}else t.identityProvider.length>1&&(t.url=window.location.protocol+"//"+window.location.host.replace(t.identityProvider,"identity-provider")+"/auth");t.url&&(this.initOptions.url=t.url),t.realm&&(this.initOptions.realm=t.realm),t.clientId&&(this.initOptions.clientId=t.clientId),t.onLoad&&(this.initOptions.onLoad=t.onLoad),t.pkceMethod&&(this.initOptions.pkceMethod=t.pkceMethod),t.identityProvider&&(this.initOptions.identityProvider=t.identityProvider),t.redirectUri&&(this.initOptions.redirectUri=t.redirectUri),t.responseMode&&(this.initOptions.responseMode=t.responseMode),t.preserveTokens&&(this.initOptions.preserveTokens=t.preserveTokens)}catch(e){const t=e.message||"error has no message";n.V.Log({logMessage:"Error on setting IAM options: "+t,logType:n.F.Error})}}getItemFromCookies(e){var t,i,s,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(i=o[t].substr(0,o[t].indexOf("=")),s=o[t].substr(o[t].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))==e)return unescape(s)}configureNewOAuthSettings(e){this.authOptions.active=e.active;const t=e.idendityProviderURL||"";var i=new URLSearchParams(window.location.search);"identityProvider"===e.subdomainSource?e.subdomainValue&&e.subdomainValue.length>1?this.authOptions.url=window.location.protocol+"//"+window.location.host.replace(e.subdomainValue,"identity-provider")+"/auth":console.error("Subdomain value must not be empty!"):(this.authOptions.subdomain=this.getSubdomain(e,i),this.authOptions.url=this.replaceSubdomain(t,this.authOptions)),this.authOptions.realm=this.getRealm(e,i),this.authOptions.language=this.getLocale(e,i),this.authOptions.clientId=e.clientId,this.authOptions.preserveTokens=e.preserveTokens,this.authOptions.redirectUri=e.redirectUri,this.authOptions.onLoad=e.onLoad,this.authOptions.popup=e.popup,this.authOptions.sessionStorageNamePrefix=e.sessionStorageNamePrefix}getLocale(e,t){if(e.isLangFromQS){const i=e.language&&""!=e.language.trim()?e.language:"lang";if(null!=t.get(i))e.language=t.get(i),e.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+e.language+";path=/;");else if(!e.sessionStorageNamePrefix){let t=this.getItemFromCookies("queryParamsLocaleIAM");t&&(e.language=t)}}return e.language}replaceSubdomain(e,t){const i=e.split(".");return i[1]=t.subdomain||i[1],i.join(".")}getRealm(e,t){if(e.isRealmFromQS)if(null!=t.get("realm"))e.realm=t.get("realm"),e.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+e.realm+";path=/;");else if(!e.sessionStorageNamePrefix){let t=this.getItemFromCookies("queryParamsRealmIAM");t&&(e.realm=t)}return e.realm}getSubdomain(e,t){let i="";switch(e.subdomainSource){case"constant":i=e.subdomainValue;break;case"query":i=t.get("subdomain");break;case"currentDomain":i=window.location.host.split(".")[0]}return i}isAuthenticated(){if(null!=this.iamPlateau?.token)return!0}async init(e,t){const i=this.authOptions.active?this.authOptions:this.initOptions;this.sessionStorageNamePrefix=this.settingsIAM?.iam?.options?.sessionStorageNamePrefix||this.authOptions.sessionStorageNamePrefix?`${this.settingsIAM?.iam?.options?.sessionStorageNamePrefix||this.authOptions.sessionStorageNamePrefix}_`:"",this.keycloak=(0,s.A)(i);const o=this.getTokens();let n=this.getKeyCloakOptions(),a=this.getLoginOptions();o&&o.idToken&&o.refreshToken&&o.token&&(n.idToken=o.idToken,n.refreshToken=o.refreshToken,n.token=o.token);const r=this.authOptions.active?this.authOptions.redirectUri:this.initOptions.redirectUri;let h=this.setQueryOrFragment(new URL(window.location.href),r);h&&(a.redirectUri=h,n.redirectUri=h);let l=!1;if((t?.iamWithPopup??(this.settingsIAM?.iam?.popup||this.authOptions.popup))&&!t?.iamInPopup)l=await this.handleIAMPopup(t,n,this.keycloak);else if(l=await this.keycloak.init(n),!l)return void await this.keycloak.login(a);t?.iamInPopup?this.handleInPopup():(this.setTokens(),"boolean"==typeof l&&(l?this.constructIAMPlateau():window.location.reload(),e()))}async handleIAMPopup(e,t,i){let s;const n=(0,a.e)(),h=async t=>{if(t.source==l)switch(t.data.type){case"setTokens":return window.removeEventListener("message",h),"setTokens"==t.data.type&&n.resolver(t.data.tokenInfo),void clearInterval(s);case"iamReady":const i=(e=>{const t={};for(const i in e)if(e.hasOwnProperty(i)){const s=e[i];"string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s&&null!==s||(t[i]=s)}return t})(window);return void r(l,{type:"iamOptions",options:e,tokens:this.getTokens(),sessionStorageNamePrefix:this.sessionStorageNamePrefix,parentWindow:i})}};window.addEventListener("message",h);const l=window.open(o.V.concatUrl(o.V.getScriptRoot(),"../assets/oidc.html"),"plateauIAMPopup","popup");if(!l){const e="Failed to open new window.";throw console.error(e),e}s=setInterval(()=>{if(l.closed){clearInterval(s);const e="popup window closed before authentication";console.error(e),n.reject(new Error(e))}},500);const u=await n.promise;return this.setToOptions(t,u),i.init(t)}handleInPopup(){const e=this.getTokenFromKeycloak();if(!e)throw new Error("could not retrieve tokenInfo from keycloak");r(opener,{type:"setTokens",tokenInfo:e}),window.close()}pathJoin(e,t){return(e=e.endsWith("/")?e.substring(0,e.length-1):e)+"/"+(t.startsWith("/")?t.substring(1):t)}setQueryOrFragment(e,t){if(!t)return;if(null!=h.find(e=>t.startsWith(e)))return t;const i=new URL("http://a.com/"+t),s="/"==e.pathname?"":e.pathname,o="/"==i.pathname?"":i.pathname;let n=s&&o?o.startsWith("//")?o.substring(1):this.pathJoin(s,o):s||o,a=e.search&&i.search?e.search+i.search.replace("?","&"):e.search||i.search,r=e.hash&&i.hash?e.hash+i.hash.replace("#","&"):e.hash||i.hash;return e.origin+n+a+r}constructIAMPlateau(){null==this.iamPlateau?this.iamPlateau={token:this.keycloak?.token,info:this.keycloak?.tokenParsed}:this.iamPlateau.token=this.keycloak?.token,window.location.search&&(document.cookie="queryParamsIAM="+window.location.search+";path=/;")}getTokens(){if(this.authOptions.preserveTokens||this.settingsIAM?.iam?.options?.preserveTokens)return{idToken:sessionStorage.getItem(this.sessionStorageNamePrefix+"kcIdToken")??void 0,refreshToken:sessionStorage.getItem(this.sessionStorageNamePrefix+"kcRefreshToken")??void 0,token:sessionStorage.getItem(this.sessionStorageNamePrefix+"kcToken")??void 0}}getTokenFromKeycloak(){if(this.keycloak&&this.keycloak.idToken&&this.keycloak.refreshToken&&this.keycloak.token)return{idToken:this.keycloak.idToken,refreshToken:this.keycloak.refreshToken,token:this.keycloak.token,info:this.keycloak.tokenParsed}}setToOptions(e,t){e.idToken=t.idToken,e.refreshToken=t.refreshToken,e.token=t.token}setTokens(e={}){if(!this.authOptions.preserveTokens&&!this.settingsIAM?.iam?.options?.preserveTokens)return;const t=e.tokenInfo??this.getTokenFromKeycloak();t&&(sessionStorage.setItem(this.sessionStorageNamePrefix+"kcIdToken",t.idToken),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcRefreshToken",t.refreshToken),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcToken",t.token))}async refreshPromise(){let e=!1;try{e=await(this.keycloak?.updateToken(this.updateTime)),this.constructIAMPlateau(),this.setTokens()}catch(e){window.location.href=window.location.protocol+"//"+window.location.host}return e}getKeyCloakOptions(){return this.authOptions.active?{onLoad:"login-required",pkceMethod:"S256",checkLoginIframe:!1,responseMode:"fragment"}:{onLoad:this.initOptions.onLoad,pkceMethod:this.initOptions.pkceMethod,checkLoginIframe:!1,responseMode:this.initOptions.responseMode}}getLoginOptions(){return{locale:this.authOptions.language||this.initOptions.locale}}logout(){let e=window.location.protocol+"//"+window.location.host,t=this.getLogoutURLParams();e=this.getRedirectURL(t,e),n.V.Log({logMessage:"getredirectURL:"}),n.V.Log({logMessage:e});const i={redirectUri:e},s=this.keycloak?.createLogoutUrl(i),o={redirectUri:s};this.keycloak?.logout(o)}getRedirectURL(e,t){return(this.authOptions.active||"queryString"===this.initOptions.identityProvider.type)&&e.reduce((e,i,s)=>i.value?t=t+(0===s?"?":"&")+`${i.key}=${i.value}`:e,""),t}getLogoutURLParams(){const e=this.authOptions.active?this.authOptions:this.initOptions,t=this.authOptions.active?this.authOptions.language:this.initOptions.locale;return[{key:"realm",value:e.realm},{key:"subdomain",value:e.subdomain},{key:"lang",value:t}]}async login(e){await this.init(()=>{},e)}}var u=i(86359);const c=["https://","http://"];class d{constructor(){this.initOptions={url:"http://identity-provider.dev.rally.softtech/auth/",realm:"main",clientId:"ui-web-client",onLoad:"login-required",pkceMethod:"S256",identityProvider:"",locale:""},this.authOptions={url:"",active:!1},this.sessionStorageNamePrefix="",this.user=null,this.iamPlateau=void 0,this.getToken=()=>this.user?.access_token||void 0,this.getInfo=()=>this.user?.profile||void 0}setOptions({iam:e,iamV2:t}){if(this.settingsIAM={iam:e,iamV2:t},t?.active)this.configureNewOAuthSettings(t);else try{const t=e?.options;if(!t)throw new Error("iam in settings is missing options");if(null!=t.identityProvider)if("object"==typeof t.identityProvider){var i="",s=t.url.split("."),o=2;try{(o=parseInt(t.identityProvider.order))<=0&&(o=2)}catch(e){o=2}if("queryString"===t.identityProvider.type){var a=new URLSearchParams(window.location.search);if(null!=a.get("subdomain")&&(i=a.get("subdomain"),s[o-1]=i,this.initOptions.subdomain=i),null!=a.get("realm"))t.realm=a.get("realm"),t.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+t.realm+";path=/;");else if(!t.sessionStorageNamePrefix){let e=this.getItemFromCookies("queryParamsRealmIAM");e&&(t.realm=e)}const e=t.localeQueryStringKey||"ui_locales";if(null!=a.get(e))this.initOptions.locale=a.get(e),t.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+this.initOptions.locale+";path=/;");else if(this.initOptions.locale=void 0,!t.sessionStorageNamePrefix){let e=this.getItemFromCookies("queryParamsLocaleIAM");e&&(this.initOptions.locale=e)}t.url=s.join(".")}else"subdomain"===t.identityProvider.type&&(i=window.location.host.split(".")[0],s[o-1]=i,t.url=s.join("."))}else t.identityProvider.length>1&&(t.url=this.normalizeAuthBaseUrl(t.url));t.url&&(this.initOptions.url=this.normalizeAuthBaseUrl(t.url)),t.realm&&(this.initOptions.realm=t.realm),t.clientId&&(this.initOptions.clientId=t.clientId),t.onLoad&&(this.initOptions.onLoad=t.onLoad),t.pkceMethod&&(this.initOptions.pkceMethod=t.pkceMethod),t.identityProvider&&(this.initOptions.identityProvider=t.identityProvider),t.redirectUri&&(this.initOptions.redirectUri=t.redirectUri),t.responseMode&&(this.initOptions.responseMode=t.responseMode),t.preserveTokens&&(this.initOptions.preserveTokens=t.preserveTokens),t.useStaticOidcMetadata&&(this.initOptions.useStaticOidcMetadata=t.useStaticOidcMetadata)}catch(e){const t=e.message||"error has no message";n.V.Log({logMessage:"Error on setting IAM options: "+t,logType:n.F.Error})}}getItemFromCookies(e){var t,i,s,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(i=o[t].substr(0,o[t].indexOf("=")),s=o[t].substr(o[t].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))==e)return unescape(s)}configureNewOAuthSettings(e){this.authOptions.active=e.active;const t=e.idendityProviderURL||"",i=new URLSearchParams(window.location.search);"identityProvider"===e.subdomainSource?e.subdomainValue&&e.subdomainValue.length>1?this.authOptions.url=window.location.protocol+"//"+window.location.host.replace(e.subdomainValue,"identity-provider")+"/auth":console.error("Subdomain value must not be empty!"):(this.authOptions.subdomain=this.getSubdomain(e,i),this.authOptions.url=this.replaceSubdomain(t,this.authOptions.subdomain)),this.authOptions.realm=this.getRealm(e,i),this.authOptions.language=this.getLocale(e,i),this.authOptions.clientId=e.clientId,this.authOptions.preserveTokens=e.preserveTokens,this.authOptions.redirectUri=e.redirectUri,this.authOptions.onLoad=e.onLoad,this.authOptions.popup=e.popup,this.authOptions.sessionStorageNamePrefix=e.sessionStorageNamePrefix}getLocale(e,t){if(e.isLangFromQS){const i=e.language?e.language:"lang";if(null!=t.get(i))e.language=t.get(i),e.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+e.language+";path=/;");else if(!e.sessionStorageNamePrefix){let t=this.getItemFromCookies("queryParamsLocaleIAM");t&&(e.language=t)}}return e.language}getRealm(e,t){if(e.isRealmFromQS)if(null!=t.get("realm"))e.realm=t.get("realm"),e.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+e.realm+";path=/;");else if(!e.sessionStorageNamePrefix){let t=this.getItemFromCookies("queryParamsRealmIAM");t&&(e.realm=t)}return e.realm}getSubdomain(e,t){let i="";switch(e.subdomainSource){case"constant":i=e.subdomainValue;break;case"query":i=t.get("subdomain");break;case"currentDomain":i=window.location.host.split(".")[0]}return i}replaceSubdomain(e,t){if(!t)return e;const i=new URL(e),s=i.hostname.split(".");return s.length>2&&(s[0]=t,i.hostname=s.join(".")),i.toString()}normalizeAuthBaseUrl(e){const t=new URL(e),i=t.pathname.replace(/\/+$/,"");return i.endsWith("/auth")?t.pathname=i:t.pathname=`${i}/auth`,t.toString()}isAuthenticated(){return!(!this.user||this.user.expired||!this.user.access_token)||void 0}isAuthCallbackUrl(){const e=new URLSearchParams(window.location.search||""),t=new URLSearchParams((window.location.hash||"").replace(/^#/,"")),i=e.has("code")||t.has("code"),s=e.has("state")||t.has("state");return i&&s}cleanCallbackParams(){const e=new URL(window.location.href),t=e=>{["code","state","session_state","iss"].forEach(t=>e.delete(t))},i=new URLSearchParams(e.search),s=new URLSearchParams(e.hash.replace(/^#/,""));t(i),t(s);const o=e.origin+e.pathname+(i.toString()?`?${i.toString()}`:"")+(s.toString()?`#${s.toString()}`:"");window.history.replaceState({},document.title,o)}toAbsoluteUrl(e){return e?void 0!==c.find(t=>e.startsWith(t))?e:new URL(e,window.location.href).toString():`${window.location.origin}${window.location.pathname}`}async init(e,t){this.sessionStorageNamePrefix=this.settingsIAM?.iam?.options?.sessionStorageNamePrefix||this.authOptions.sessionStorageNamePrefix?`${this.settingsIAM?.iam?.options?.sessionStorageNamePrefix||this.authOptions.sessionStorageNamePrefix}_`:"";const i=this.deriveAuthority(this.authOptions.active?this.authOptions.url:this.initOptions.url,(this.authOptions.active?this.authOptions.realm:this.initOptions.realm)||"master"),s=this.authOptions.active?this.authOptions.redirectUri:this.initOptions.redirectUri,a=this.toAbsoluteUrl(s),r={authority:i,client_id:(this.authOptions.active?this.authOptions.clientId:this.initOptions.clientId)??"ui-web-client",redirect_uri:a,post_logout_redirect_uri:window.location.origin,silent_redirect_uri:o.V.concatUrl(o.V.getScriptRoot(),"../assets/silentRenew.html"),response_type:"code",scope:"openid profile",loadUserInfo:!1,automaticSilentRenew:!0,userStore:new u.O({store:window.sessionStorage}),extraQueryParams:this.authOptions.language||this.initOptions.locale?{ui_locales:this.authOptions.language||this.initOptions.locale}:void 0};if(!0===this.initOptions.useStaticOidcMetadata&&(r.metadata={issuer:i,authorization_endpoint:`${i}/protocol/openid-connect/auth`,token_endpoint:`${i}/protocol/openid-connect/token`,end_session_endpoint:`${i}/protocol/openid-connect/logout`,jwks_uri:`${i}/protocol/openid-connect/certs`}),this.userManager=new u.$5(r),this.isAuthCallbackUrl())try{const t=await this.userManager.signinRedirectCallback();this.user=t??await this.userManager.getUser()??null,this.cleanCallbackParams(),this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch{}return}catch(e){n.V.Log({logMessage:"signinRedirectCallback failed: "+e.message,logType:n.F.Error})}if(this.user=await this.userManager.getUser()??null,this.user&&!this.user.expired){this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch{}return}const h=(this.authOptions.onLoad||this.initOptions.onLoad)??"login-required",l=(t?.iamWithPopup??(this.settingsIAM?.iam?.popup||this.authOptions.popup))&&!t?.iamInPopup;if("check-sso"!==h)if(l){await this.userManager.signinPopup(),this.user=await this.userManager.getUser()??null,this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch{}}else await this.userManager.signinRedirect()}async login(e){return this.init(()=>{},e)}async refreshPromise(e=30){if(!this.userManager)return!1;if(this.user||(this.user=await this.userManager.getUser()??null),!this.user||this.user.expired)try{const e=await this.userManager.signinSilent();return this.user=e??null,this.constructIAMPlateau(),this.maybePersistTokens(),!!e}catch(e){return console.error("Silent renew failed (expired). Redirecting to login...",e),await this.userManager.signinRedirect(),!1}const t=Math.floor(Date.now()/1e3),i=(this.user.expires_at||0)-t;if(i>e)return console.log(`Token still valid for ${i}s, skipping refresh.`),!0;try{const e=await this.userManager.signinSilent();return this.user=e??null,this.constructIAMPlateau(),this.maybePersistTokens(),console.log("Silent renew executed because token was near expiry."),!!e}catch(e){return console.error("Silent renew failed (near expiry). Redirecting to login...",e),await this.userManager.signinRedirect(),!1}}logout(){this.userManager&&this.userManager.signoutRedirect().catch(e=>{n.V.Log({logMessage:"logout error: "+e.message,logType:n.F.Error})})}deriveAuthority(e,t){const i=e.replace(/\/+$/,"");return i.endsWith("/auth")?`${i}/realms/${t}`:i.endsWith("/auth/")?`${i}realms/${t}`:`${i}/realms/${t}`}constructIAMPlateau(){if(!this.user)return void(this.iamPlateau=void 0);const e=this.user.access_token,t=this.user.profile||void 0;null==this.iamPlateau?this.iamPlateau={token:e,info:t}:this.iamPlateau.token=e,window.location.search&&(document.cookie="queryParamsIAM="+window.location.search+";path=/;")}maybePersistTokens(){if(!this.authOptions.preserveTokens&&!this.settingsIAM?.iam?.options?.preserveTokens)return;if(!this.user)return;const e=this.user.id_token||"",t=this.user.access_token||"",i=this.user.refresh_token||"";sessionStorage.setItem(this.sessionStorageNamePrefix+"kcIdToken",e),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcRefreshToken",i),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcToken",t)}}class p{constructor(){this.getToken=()=>this.activeAuthProvider.getToken(),this.getInfo=()=>this.activeAuthProvider.getInfo()}get activeAuthProvider(){if(!this.authProvider){const e=this.authProvider=new l;this.settingsIAM&&e.setOptions({iam:this.settingsIAM.iam,iamV2:this.settingsIAM.iamV2})}return this.authProvider}setOptions({iam:e,iamV2:t}){this.settingsIAM={iam:e,iamV2:t};const i=t?.iamAuth??e?.iamAuth??"keycloak";this.authProvider="oidc-client"===i?new d:new l,this.authProvider.setOptions({iam:e,iamV2:t})}isAuthenticated(){return this.activeAuthProvider.isAuthenticated()}async init(e,t){return this.activeAuthProvider.init(e,t)}async login(e){return this.activeAuthProvider.login(e)}async refreshPromise(){return this.activeAuthProvider.refreshPromise()}logout(){this.activeAuthProvider.logout()}}},77059(e,t,i){"use strict";i.d(t,{e:()=>n,u:()=>a});let s=!1;new Promise(e=>e()).then(()=>s=!0),"undefined"!=typeof doNothing&&doNothing();const o=!0===s;function n(e,t={}){let i,s,n;const a=e=>{n&&clearTimeout(n),n=setTimeout(()=>{s(new Error(`The operation has timed out. timeoutValue  : ${e}`))},e)};let r=!1,h=!1;const l=()=>r||h;return e&&a(e),{startTimer:a,promise:new Promise((e,n)=>{const a=(e=>o&&t.fixSyncResolve?t=>setTimeout(()=>e(t)):e)(e);i=e=>{l()||(r=!0,a(e))},s=e=>{l()||(h=!0,n(e))}}),resolver:i,reject:s,isResolved:()=>r,isRejected:()=>h,isCompleted:l}}function a(e){const t=n();let i=e.length;return e.forEach(async e=>{try{await e}finally{--i<=0&&t.resolver(e)}}),t.promise}}}]);