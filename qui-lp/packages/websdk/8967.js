(this.webpackChunk_stechquick_websdk=this.webpackChunk_stechquick_websdk||[]).push([[8967],{60118:(e,t,i)=>{"use strict";i.d(t,{C:()=>s,X:()=>r});var n=!1;new Promise((function(e){return e()})).then((function(){return n=!0})),"undefined"!=typeof doNothing&&doNothing();var o=!0===n;function r(e,t){void 0===t&&(t={});var i,n=void 0,r=void 0,s=function(e){i&&clearTimeout(i),i=setTimeout((function(){r(new Error("The operation has timed out. timeoutValue  : "+e))}),e)},a=!1,u=!1,l=function(){return a||u};return e&&s(e),{startTimer:s,promise:new Promise((function(e,i){var s=function(e){return o&&t.fixSyncResolve?function(t){return setTimeout((function(){return e(t)}))}:e}(e);n=function(e){l()||(a=!0,s(e))},r=function(e){l()||(u=!0,i(e))}})),resolver:n,reject:r,isResolved:function(){return a},isRejected:function(){return u},isCompleted:l}}function s(e){var t=this,i=r(),n=e.length;return e.forEach((function(e){return o=t,s=function(){return function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(t){switch(t.label){case 0:return t.trys.push([0,,2,3]),[4,e];case 1:return t.sent(),[3,3];case 2:return--n<=0&&i.resolver(e),[7];case 3:return[2]}}))},new((r=void 0)||(r=Promise))((function(e,t){function i(e){try{a(s.next(e))}catch(e){t(e)}}function n(e){try{a(s.throw(e))}catch(e){t(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(i,n)}a((s=s.apply(o,[])).next())}));var o,r,s})),i.promise}},39741:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PlateauIAM:()=>k});var n=i(64e3),o=i(36348),r=i(62190),s=i(60118);function a(e,t){e.postMessage(t,"*")}var u=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},l=function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},c=["https://","http://"],h=function(){function e(){var e=this;this.refreshTime=6e3,this.updateTime=10,this.initOptions={url:"http://identity-provider.dev.rally.softtech/auth/",realm:"main",clientId:"ui-web-client",onLoad:"login-required",pkceMethod:"S256",identityProvider:"",locale:""},this.authOptions={url:"",active:!1},this.iamPlateau=void 0,this.sessionStorageNamePrefix="",this.getToken=function(){return null!=e.iamPlateau?e.iamPlateau.token:void 0},this.getInfo=function(){return null!=e.iamPlateau?e.iamPlateau.info:void 0}}return e.prototype.setOptions=function(e){var t=e.iam,i=e.iamV2;if(null==i?void 0:i.active)this.configureNewOAuthSettings(i);else try{var n=null==t?void 0:t.options;if(!n)throw new Error("iam in settings is missing options");if(null!=n.identityProvider)if("object"==typeof n.identityProvider){var o="",s=n.url.split("."),a=2;try{(a=parseInt(n.identityProvider.order))<=0&&(a=2)}catch(e){a=2}if("queryString"===n.identityProvider.type){var u=new URLSearchParams(window.location.search);if(null!=u.get("subdomain")&&(o=u.get("subdomain"),s[a-1]=o,this.initOptions.subdomain=o),null!=u.get("realm"))n.realm=u.get("realm"),n.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+n.realm+";path=/;");else if(!n.sessionStorageNamePrefix){var l=this.getItemFromCookies("queryParamsRealmIAM");l&&(n.realm=l)}var c=n.localeQueryStringKey||"ui_locales";if(null!=u.get(c))this.initOptions.locale=u.get(c),n.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+this.initOptions.locale+";path=/;");else if(this.initOptions.locale=void 0,!n.sessionStorageNamePrefix){var h=this.getItemFromCookies("queryParamsLocaleIAM");h&&(this.initOptions.locale=h)}}else"subdomain"===n.identityProvider.type&&(o=window.location.host.split(".")[0],s[a-1]=o);n.url=s.join(".")}else n.identityProvider.length>1&&(n.url=window.location.protocol+"//"+window.location.host.replace(n.identityProvider,"identity-provider")+"/auth");n.url&&(this.initOptions.url=n.url),n.realm&&(this.initOptions.realm=n.realm),n.clientId&&(this.initOptions.clientId=n.clientId),n.onLoad&&(this.initOptions.onLoad=n.onLoad),n.pkceMethod&&(this.initOptions.pkceMethod=n.pkceMethod),n.identityProvider&&(this.initOptions.identityProvider=n.identityProvider),n.redirectUri&&(this.initOptions.redirectUri=n.redirectUri),n.responseMode&&(this.initOptions.responseMode=n.responseMode),n.preserveTokens&&(this.initOptions.preserveTokens=n.preserveTokens)}catch(e){var p=e.message||"error has no message";r.Y.Log({logMessage:"Error on setting IAM options: "+p,logType:r.h.Error})}},e.prototype.getItemFromCookies=function(e){var t,i,n,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(i=o[t].substr(0,o[t].indexOf("=")),n=o[t].substr(o[t].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))==e)return unescape(n)},e.prototype.configureNewOAuthSettings=function(e){this.authOptions.active=e.active;var t=e.idendityProviderURL||"",i=new URLSearchParams(window.location.search);"identityProvider"===e.subdomainSource?e.subdomainValue&&e.subdomainValue.length>1?this.authOptions.url=window.location.protocol+"//"+window.location.host.replace(e.subdomainValue,"identity-provider")+"/auth":console.error("Subdomain value must not be empty!"):(this.authOptions.subdomain=this.getSubdomain(e,i),this.authOptions.url=this.replaceSubdomain(t,this.authOptions)),this.authOptions.realm=this.getRealm(e,i),this.authOptions.language=this.getLocale(e,i),this.authOptions.clientId=e.clientId,this.authOptions.preserveTokens=e.preserveTokens,this.authOptions.redirectUri=e.redirectUri,this.authOptions.onLoad=e.onLoad,this.authOptions.popup=e.popup,this.authOptions.sessionStorageNamePrefix=e.sessionStorageNamePrefix},e.prototype.getLocale=function(e,t){if(e.isLangFromQS){var i=e.language&&""!=e.language.trim()?e.language:"lang";if(null!=t.get(i))e.language=t.get(i),e.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+e.language+";path=/;");else if(!e.sessionStorageNamePrefix){var n=this.getItemFromCookies("queryParamsLocaleIAM");n&&(e.language=n)}}return e.language},e.prototype.replaceSubdomain=function(e,t){var i=e.split(".");return i[1]=t.subdomain||i[1],i.join(".")},e.prototype.getRealm=function(e,t){if(e.isRealmFromQS)if(null!=t.get("realm"))e.realm=t.get("realm"),e.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+e.realm+";path=/;");else if(!e.sessionStorageNamePrefix){var i=this.getItemFromCookies("queryParamsRealmIAM");i&&(e.realm=i)}return e.realm},e.prototype.getSubdomain=function(e,t){var i="";switch(e.subdomainSource){case"constant":i=e.subdomainValue;break;case"query":i=t.get("subdomain");break;case"currentDomain":i=window.location.host.split(".")[0]}return i},e.prototype.isAuthenticated=function(){var e;if(null!=(null===(e=this.iamPlateau)||void 0===e?void 0:e.token))return!0},e.prototype.init=function(e,t){var i,o,r,s,a,c,h,p,d;return u(this,void 0,void 0,(function(){var u,f,v,m,g,y,k;return l(this,(function(l){switch(l.label){case 0:return u=this.authOptions.active?this.authOptions:this.initOptions,this.sessionStorageNamePrefix=(null===(r=null===(o=null===(i=this.settingsIAM)||void 0===i?void 0:i.iam)||void 0===o?void 0:o.options)||void 0===r?void 0:r.sessionStorageNamePrefix)||this.authOptions.sessionStorageNamePrefix?((null===(c=null===(a=null===(s=this.settingsIAM)||void 0===s?void 0:s.iam)||void 0===a?void 0:a.options)||void 0===c?void 0:c.sessionStorageNamePrefix)||this.authOptions.sessionStorageNamePrefix)+"_":"",this.keycloak=(0,n.Z)(u),f=this.getTokens(),v=this.getKeyCloakOptions(),m=this.getLoginOptions(),f&&f.idToken&&f.refreshToken&&f.token&&(v.idToken=f.idToken,v.refreshToken=f.refreshToken,v.token=f.token),g=this.authOptions.active?this.authOptions.redirectUri:this.initOptions.redirectUri,(y=this.setQueryOrFragment(new URL(window.location.href),g))&&(m.redirectUri=y,v.redirectUri=y),k=!1,(null!==(h=null==t?void 0:t.iamWithPopup)&&void 0!==h?h:(null===(d=null===(p=this.settingsIAM)||void 0===p?void 0:p.iam)||void 0===d?void 0:d.popup)||this.authOptions.popup)&&!(null==t?void 0:t.iamInPopup)?[4,this.handleIAMPopup(t,v,this.keycloak)]:[3,2];case 1:return k=l.sent(),[3,5];case 2:return[4,this.keycloak.init(v)];case 3:return(k=l.sent())?[3,5]:[4,this.keycloak.login(m)];case 4:return l.sent(),[2];case 5:return(null==t?void 0:t.iamInPopup)?(this.handleInPopup(),[2]):(this.setTokens(),"boolean"==typeof k&&(k?this.constructIAMPlateau():window.location.reload(),e()),[2])}}))}))},e.prototype.handleIAMPopup=function(e,t,i){return u(this,void 0,void 0,(function(){var n,r,c,h,p,d,f,v=this;return l(this,(function(m){switch(m.label){case 0:if(r=(0,s.X)(),c=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n&&null!==n||(t[i]=n)}return t},h=function(t){return u(v,void 0,void 0,(function(){var i;return l(this,(function(o){if(t.source!=p)return[2];switch(t.data.type){case"setTokens":return window.removeEventListener("message",h),"setTokens"==t.data.type&&r.resolver(t.data.tokenInfo),clearInterval(n),[2];case"iamReady":return i=c(window),a(p,{type:"iamOptions",options:e,tokens:this.getTokens(),sessionStorageNamePrefix:this.sessionStorageNamePrefix,parentWindow:i}),[2]}return[2]}))}))},window.addEventListener("message",h),!(p=window.open(o.t.concatUrl(o.t.getScriptRoot(),"../assets/oidc.html"),"plateauIAMPopup","popup")))throw d="Failed to open new window.",console.error(d),d;return n=setInterval((function(){if(p.closed){clearInterval(n);var e="popup window closed before authentication";console.error(e),r.reject(new Error(e))}}),500),[4,r.promise];case 1:return f=m.sent(),this.setToOptions(t,f),[2,i.init(t)]}}))}))},e.prototype.handleInPopup=function(){var e=this.getTokenFromKeycloak();if(!e)throw new Error("could not retrieve tokenInfo from keycloak");a(opener,{type:"setTokens",tokenInfo:e}),window.close()},e.prototype.pathJoin=function(e,t){return(e=e.endsWith("/")?e.substring(0,e.length-1):e)+"/"+(t.startsWith("/")?t.substring(1):t)},e.prototype.setQueryOrFragment=function(e,t){if(t){if(null!=c.find((function(e){return t.startsWith(e)})))return t;var i=new URL("http://a.com/"+t),n="/"==e.pathname?"":e.pathname,o="/"==i.pathname?"":i.pathname,r=n&&o?o.startsWith("//")?o.substring(1):this.pathJoin(n,o):n||o,s=e.search&&i.search?e.search+i.search.replace("?","&"):e.search||i.search,a=e.hash&&i.hash?e.hash+i.hash.replace("#","&"):e.hash||i.hash;return e.origin+r+s+a}},e.prototype.constructIAMPlateau=function(){var e,t,i;null==this.iamPlateau?this.iamPlateau={token:null===(e=this.keycloak)||void 0===e?void 0:e.token,info:null===(t=this.keycloak)||void 0===t?void 0:t.tokenParsed}:this.iamPlateau.token=null===(i=this.keycloak)||void 0===i?void 0:i.token,window.location.search&&(document.cookie="queryParamsIAM="+window.location.search+";path=/;")},e.prototype.getTokens=function(){var e,t,i,n,o,r;if(this.authOptions.preserveTokens||(null===(i=null===(t=null===(e=this.settingsIAM)||void 0===e?void 0:e.iam)||void 0===t?void 0:t.options)||void 0===i?void 0:i.preserveTokens))return{idToken:null!==(n=sessionStorage.getItem(this.sessionStorageNamePrefix+"kcIdToken"))&&void 0!==n?n:void 0,refreshToken:null!==(o=sessionStorage.getItem(this.sessionStorageNamePrefix+"kcRefreshToken"))&&void 0!==o?o:void 0,token:null!==(r=sessionStorage.getItem(this.sessionStorageNamePrefix+"kcToken"))&&void 0!==r?r:void 0}},e.prototype.getTokenFromKeycloak=function(){if(this.keycloak&&this.keycloak.idToken&&this.keycloak.refreshToken&&this.keycloak.token)return{idToken:this.keycloak.idToken,refreshToken:this.keycloak.refreshToken,token:this.keycloak.token,info:this.keycloak.tokenParsed}},e.prototype.setToOptions=function(e,t){e.idToken=t.idToken,e.refreshToken=t.refreshToken,e.token=t.token},e.prototype.setTokens=function(e){var t,i,n,o;if(void 0===e&&(e={}),this.authOptions.preserveTokens||(null===(n=null===(i=null===(t=this.settingsIAM)||void 0===t?void 0:t.iam)||void 0===i?void 0:i.options)||void 0===n?void 0:n.preserveTokens)){var r=null!==(o=e.tokenInfo)&&void 0!==o?o:this.getTokenFromKeycloak();r&&(sessionStorage.setItem(this.sessionStorageNamePrefix+"kcIdToken",r.idToken),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcRefreshToken",r.refreshToken),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcToken",r.token))}},e.prototype.refreshPromise=function(){var e;return u(this,void 0,void 0,(function(){var t;return l(this,(function(i){switch(i.label){case 0:t=!1,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,null===(e=this.keycloak)||void 0===e?void 0:e.updateToken(this.updateTime)];case 2:return t=i.sent(),this.constructIAMPlateau(),this.setTokens(),[3,4];case 3:return i.sent(),window.location.href=window.location.protocol+"//"+window.location.host,[3,4];case 4:return[2,t]}}))}))},e.prototype.getKeyCloakOptions=function(){return this.authOptions.active?{onLoad:"login-required",pkceMethod:"S256",checkLoginIframe:!1,responseMode:"fragment"}:{onLoad:this.initOptions.onLoad,pkceMethod:this.initOptions.pkceMethod,checkLoginIframe:!1,responseMode:this.initOptions.responseMode}},e.prototype.getLoginOptions=function(){return{locale:this.authOptions.language||this.initOptions.locale}},e.prototype.logout=function(){var e,t,i=window.location.protocol+"//"+window.location.host,n=this.getLogoutURLParams();i=this.getRedirectURL(n,i),r.Y.Log({logMessage:"getredirectURL:"}),r.Y.Log({logMessage:i});var o={redirectUri:i},s={redirectUri:null===(e=this.keycloak)||void 0===e?void 0:e.createLogoutUrl(o)};null===(t=this.keycloak)||void 0===t||t.logout(s)},e.prototype.getRedirectURL=function(e,t){return(this.authOptions.active||"queryString"===this.initOptions.identityProvider.type)&&e.reduce((function(e,i,n){return i.value?t=t+(0===n?"?":"&")+i.key+"="+i.value:e}),""),t},e.prototype.getLogoutURLParams=function(){var e=this.authOptions.active?this.authOptions:this.initOptions,t=this.authOptions.active?this.authOptions.language:this.initOptions.locale;return[{key:"realm",value:e.realm},{key:"subdomain",value:e.subdomain},{key:"lang",value:t}]},e.prototype.login=function(e){return u(this,void 0,void 0,(function(){var t;return l(this,(function(i){switch(i.label){case 0:return t=function(){},[4,this.init(t,e)];case 1:return i.sent(),[2]}}))}))},e}(),p=i(65637),d=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},f=function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},v=["https://","http://"],m=function(){function e(){var e=this;this.initOptions={url:"http://identity-provider.dev.rally.softtech/auth/",realm:"main",clientId:"ui-web-client",onLoad:"login-required",pkceMethod:"S256",identityProvider:"",locale:""},this.authOptions={url:"",active:!1},this.sessionStorageNamePrefix="",this.user=null,this.iamPlateau=void 0,this.getToken=function(){var t;return(null===(t=e.user)||void 0===t?void 0:t.access_token)||void 0},this.getInfo=function(){var t;return(null===(t=e.user)||void 0===t?void 0:t.profile)||void 0}}return e.prototype.setOptions=function(e){var t=e.iam,i=e.iamV2;if(null==i?void 0:i.active)this.configureNewOAuthSettings(i);else try{var n=null==t?void 0:t.options;if(!n)throw new Error("iam in settings is missing options");if(null!=n.identityProvider)if("object"==typeof n.identityProvider){var o="",s=n.url.split("."),a=2;try{(a=parseInt(n.identityProvider.order))<=0&&(a=2)}catch(e){a=2}if("queryString"===n.identityProvider.type){var u=new URLSearchParams(window.location.search);if(null!=u.get("subdomain")&&(o=u.get("subdomain"),s[a-1]=o,this.initOptions.subdomain=o),null!=u.get("realm"))n.realm=u.get("realm"),n.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+n.realm+";path=/;");else if(!n.sessionStorageNamePrefix){var l=this.getItemFromCookies("queryParamsRealmIAM");l&&(n.realm=l)}var c=n.localeQueryStringKey||"ui_locales";if(null!=u.get(c))this.initOptions.locale=u.get(c),n.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+this.initOptions.locale+";path=/;");else if(this.initOptions.locale=void 0,!n.sessionStorageNamePrefix){var h=this.getItemFromCookies("queryParamsLocaleIAM");h&&(this.initOptions.locale=h)}n.url=s.join(".")}else"subdomain"===n.identityProvider.type&&(o=window.location.host.split(".")[0],s[a-1]=o,n.url=s.join("."))}else n.identityProvider.length>1&&(n.url=this.normalizeAuthBaseUrl(n.url));n.url&&(this.initOptions.url=this.normalizeAuthBaseUrl(n.url)),n.realm&&(this.initOptions.realm=n.realm),n.clientId&&(this.initOptions.clientId=n.clientId),n.onLoad&&(this.initOptions.onLoad=n.onLoad),n.pkceMethod&&(this.initOptions.pkceMethod=n.pkceMethod),n.identityProvider&&(this.initOptions.identityProvider=n.identityProvider),n.redirectUri&&(this.initOptions.redirectUri=n.redirectUri),n.responseMode&&(this.initOptions.responseMode=n.responseMode),n.preserveTokens&&(this.initOptions.preserveTokens=n.preserveTokens),n.useStaticOidcMetadata&&(this.initOptions.useStaticOidcMetadata=n.useStaticOidcMetadata)}catch(e){var p=e.message||"error has no message";r.Y.Log({logMessage:"Error on setting IAM options: "+p,logType:r.h.Error})}},e.prototype.getItemFromCookies=function(e){var t,i,n,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(i=o[t].substr(0,o[t].indexOf("=")),n=o[t].substr(o[t].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))==e)return unescape(n)},e.prototype.configureNewOAuthSettings=function(e){this.authOptions.active=e.active;var t=e.idendityProviderURL||"",i=new URLSearchParams(window.location.search);"identityProvider"===e.subdomainSource?e.subdomainValue&&e.subdomainValue.length>1?this.authOptions.url=window.location.protocol+"//"+window.location.host.replace(e.subdomainValue,"identity-provider")+"/auth":console.error("Subdomain value must not be empty!"):(this.authOptions.subdomain=this.getSubdomain(e,i),this.authOptions.url=this.replaceSubdomain(t,this.authOptions.subdomain)),this.authOptions.realm=this.getRealm(e,i),this.authOptions.language=this.getLocale(e,i),this.authOptions.clientId=e.clientId,this.authOptions.preserveTokens=e.preserveTokens,this.authOptions.redirectUri=e.redirectUri,this.authOptions.onLoad=e.onLoad,this.authOptions.popup=e.popup,this.authOptions.sessionStorageNamePrefix=e.sessionStorageNamePrefix},e.prototype.getLocale=function(e,t){if(e.isLangFromQS){var i=e.language?e.language:"lang";if(null!=t.get(i))e.language=t.get(i),e.sessionStorageNamePrefix||(document.cookie="queryParamsLocaleIAM="+e.language+";path=/;");else if(!e.sessionStorageNamePrefix){var n=this.getItemFromCookies("queryParamsLocaleIAM");n&&(e.language=n)}}return e.language},e.prototype.getRealm=function(e,t){if(e.isRealmFromQS)if(null!=t.get("realm"))e.realm=t.get("realm"),e.sessionStorageNamePrefix||(document.cookie="queryParamsRealmIAM="+e.realm+";path=/;");else if(!e.sessionStorageNamePrefix){var i=this.getItemFromCookies("queryParamsRealmIAM");i&&(e.realm=i)}return e.realm},e.prototype.getSubdomain=function(e,t){var i="";switch(e.subdomainSource){case"constant":i=e.subdomainValue;break;case"query":i=t.get("subdomain");break;case"currentDomain":i=window.location.host.split(".")[0]}return i},e.prototype.replaceSubdomain=function(e,t){if(!t)return e;var i=new URL(e),n=i.hostname.split(".");return n.length>2&&(n[0]=t,i.hostname=n.join(".")),i.toString()},e.prototype.normalizeAuthBaseUrl=function(e){var t=new URL(e),i=t.pathname.replace(/\/+$/,"");return i.endsWith("/auth")?t.pathname=i:t.pathname=i+"/auth",t.toString()},e.prototype.isAuthenticated=function(){return!(!this.user||this.user.expired||!this.user.access_token)||void 0},e.prototype.isAuthCallbackUrl=function(){var e=new URLSearchParams(window.location.search||""),t=new URLSearchParams((window.location.hash||"").replace(/^#/,"")),i=e.has("code")||t.has("code"),n=e.has("state")||t.has("state");return i&&n},e.prototype.cleanCallbackParams=function(){var e=new URL(window.location.href),t=function(e){["code","state","session_state","iss"].forEach((function(t){return e.delete(t)}))},i=new URLSearchParams(e.search),n=new URLSearchParams(e.hash.replace(/^#/,""));t(i),t(n);var o=e.origin+e.pathname+(i.toString()?"?"+i.toString():"")+(n.toString()?"#"+n.toString():"");window.history.replaceState({},document.title,o)},e.prototype.toAbsoluteUrl=function(e){return e?void 0!==v.find((function(t){return e.startsWith(t)}))?e:new URL(e,window.location.href).toString():""+window.location.origin+window.location.pathname},e.prototype.init=function(e,t){var i,n,s,a,u,l,c,h,v,m,g,y,k,w,P;return d(this,void 0,void 0,(function(){var d,b,O,S,I,M,T,x,A,L,R,U,N,_,q;return f(this,(function(f){switch(f.label){case 0:if(this.sessionStorageNamePrefix=(null===(s=null===(n=null===(i=this.settingsIAM)||void 0===i?void 0:i.iam)||void 0===n?void 0:n.options)||void 0===s?void 0:s.sessionStorageNamePrefix)||this.authOptions.sessionStorageNamePrefix?((null===(l=null===(u=null===(a=this.settingsIAM)||void 0===a?void 0:a.iam)||void 0===u?void 0:u.options)||void 0===l?void 0:l.sessionStorageNamePrefix)||this.authOptions.sessionStorageNamePrefix)+"_":"",d=this.deriveAuthority(this.authOptions.active?this.authOptions.url:this.initOptions.url,(this.authOptions.active?this.authOptions.realm:this.initOptions.realm)||"master"),b=this.authOptions.active?this.authOptions.redirectUri:this.initOptions.redirectUri,O=this.toAbsoluteUrl(b),S=void 0,I=null!==(c=this.authOptions.active?this.authOptions.clientId:this.initOptions.clientId)&&void 0!==c?c:"ui-web-client",M={authority:d,client_id:I,redirect_uri:O,post_logout_redirect_uri:window.location.origin,silent_redirect_uri:o.t.concatUrl(o.t.getScriptRoot(),"../assets/silentRenew.html"),response_type:"code",scope:"openid profile",loadUserInfo:!1,automaticSilentRenew:!0,userStore:new p.bA({store:window.sessionStorage}),extraQueryParams:this.authOptions.language||this.initOptions.locale?{ui_locales:this.authOptions.language||this.initOptions.locale}:void 0},!0===this.initOptions.useStaticOidcMetadata&&(M.metadata={issuer:d,authorization_endpoint:d+"/protocol/openid-connect/auth",token_endpoint:d+"/protocol/openid-connect/token",end_session_endpoint:d+"/protocol/openid-connect/logout",jwks_uri:d+"/protocol/openid-connect/certs"}),this.userManager=new p.ws(M),!this.isAuthCallbackUrl())return[3,7];f.label=1;case 1:return f.trys.push([1,6,,7]),[4,this.userManager.signinRedirectCallback()];case 2:return T=f.sent(),x=this,null==T?[3,3]:(A=T,[3,5]);case 3:return[4,this.userManager.getUser()];case 4:A=f.sent(),f.label=5;case 5:x.user=null!==(h=A)&&void 0!==h?h:null,this.cleanCallbackParams(),this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch(e){}return[2];case 6:return L=f.sent(),r.Y.Log({logMessage:"signinRedirectCallback failed: "+L.message,logType:r.h.Error}),[3,7];case 7:return R=this,[4,this.userManager.getUser()];case 8:if(R.user=null!==(v=f.sent())&&void 0!==v?v:null,this.user&&!this.user.expired){this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch(e){}return[2]}if(U=null!==(m=this.authOptions.onLoad||this.initOptions.onLoad)&&void 0!==m?m:"login-required",N=(null!==(g=null==t?void 0:t.iamWithPopup)&&void 0!==g?g:(null===(k=null===(y=this.settingsIAM)||void 0===y?void 0:y.iam)||void 0===k?void 0:k.popup)||this.authOptions.popup)&&!(null==t?void 0:t.iamInPopup),"check-sso"!==U)return[3,14];if(!S)return[3,13];f.label=9;case 9:return f.trys.push([9,12,,13]),[4,this.userManager.signinSilent()];case 10:return f.sent(),_=this,[4,this.userManager.getUser()];case 11:_.user=null!==(w=f.sent())&&void 0!==w?w:null,this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch(e){}return[3,13];case 12:return f.sent(),[3,13];case 13:return[2];case 14:return N?[4,this.userManager.signinPopup()]:[3,17];case 15:return f.sent(),q=this,[4,this.userManager.getUser()];case 16:q.user=null!==(P=f.sent())&&void 0!==P?P:null,this.constructIAMPlateau(),this.maybePersistTokens();try{e()}catch(e){}return[2];case 17:return[4,this.userManager.signinRedirect()];case 18:return f.sent(),[2]}}))}))},e.prototype.login=function(e){return d(this,void 0,void 0,(function(){var t;return f(this,(function(i){return t=function(){},[2,this.init(t,e)]}))}))},e.prototype.refreshPromise=function(e){var t;return void 0===e&&(e=30),d(this,void 0,void 0,(function(){var i,n,o,r,s,a,u;return f(this,(function(l){switch(l.label){case 0:return this.userManager?this.user?[3,2]:(i=this,[4,this.userManager.getUser()]):[2,!1];case 1:i.user=null!==(t=l.sent())&&void 0!==t?t:null,l.label=2;case 2:if(this.user&&!this.user.expired)return[3,7];l.label=3;case 3:return l.trys.push([3,5,,7]),[4,this.userManager.signinSilent()];case 4:return a=l.sent(),this.user=null!=a?a:null,this.constructIAMPlateau(),this.maybePersistTokens(),[2,!!a];case 5:return n=l.sent(),console.error("Silent renew failed (expired). Redirecting to login...",n),[4,this.userManager.signinRedirect()];case 6:return l.sent(),[2,!1];case 7:if(o=Math.floor(Date.now()/1e3),r=this.user.expires_at||0,(s=r-o)>e)return console.log("Token still valid for "+s+"s, skipping refresh."),[2,!0];l.label=8;case 8:return l.trys.push([8,10,,12]),[4,this.userManager.signinSilent()];case 9:return a=l.sent(),this.user=null!=a?a:null,this.constructIAMPlateau(),this.maybePersistTokens(),console.log("Silent renew executed because token was near expiry."),[2,!!a];case 10:return u=l.sent(),console.error("Silent renew failed (near expiry). Redirecting to login...",u),[4,this.userManager.signinRedirect()];case 11:return l.sent(),[2,!1];case 12:return[2]}}))}))},e.prototype.logout=function(){this.userManager&&this.userManager.signoutRedirect().catch((function(e){r.Y.Log({logMessage:"logout error: "+e.message,logType:r.h.Error})}))},e.prototype.deriveAuthority=function(e,t){var i=e.replace(/\/+$/,"");return i.endsWith("/auth")?i+"/realms/"+t:i.endsWith("/auth/")?i+"realms/"+t:i+"/realms/"+t},e.prototype.constructIAMPlateau=function(){if(this.user){var e=this.user.access_token,t=this.user.profile||void 0;null==this.iamPlateau?this.iamPlateau={token:e,info:t}:this.iamPlateau.token=e,window.location.search&&(document.cookie="queryParamsIAM="+window.location.search+";path=/;")}else this.iamPlateau=void 0},e.prototype.maybePersistTokens=function(){var e,t,i;if((this.authOptions.preserveTokens||(null===(i=null===(t=null===(e=this.settingsIAM)||void 0===e?void 0:e.iam)||void 0===t?void 0:t.options)||void 0===i?void 0:i.preserveTokens))&&this.user){var n=this.user.id_token||"",o=this.user.access_token||"",r=this.user.refresh_token||"";sessionStorage.setItem(this.sessionStorageNamePrefix+"kcIdToken",n),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcRefreshToken",r),sessionStorage.setItem(this.sessionStorageNamePrefix+"kcToken",o)}},e}(),g=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},y=function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},k=function(){function e(){var e=this;this.getToken=function(){return e.activeAuthProvider.getToken()},this.getInfo=function(){return e.activeAuthProvider.getInfo()}}return Object.defineProperty(e.prototype,"activeAuthProvider",{get:function(){if(!this.authProvider){var e=this.authProvider=new h;this.settingsIAM&&e.setOptions({iam:this.settingsIAM.iam,iamV2:this.settingsIAM.iamV2})}return this.authProvider},enumerable:!1,configurable:!0}),e.prototype.setOptions=function(e){var t,i,n=e.iam,o=e.iamV2;this.settingsIAM={iam:n,iamV2:o};var r=null!==(i=null!==(t=null==o?void 0:o.iamAuth)&&void 0!==t?t:null==n?void 0:n.iamAuth)&&void 0!==i?i:"keycloak";this.authProvider="oidc-client"===r?new m:new h,this.authProvider.setOptions({iam:n,iamV2:o})},e.prototype.isAuthenticated=function(){return this.activeAuthProvider.isAuthenticated()},e.prototype.init=function(e,t){return g(this,void 0,void 0,(function(){return y(this,(function(i){return[2,this.activeAuthProvider.init(e,t)]}))}))},e.prototype.login=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this.activeAuthProvider.login(e)]}))}))},e.prototype.refreshPromise=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){return[2,this.activeAuthProvider.refreshPromise()]}))}))},e.prototype.logout=function(){this.activeAuthProvider.logout()},e}()},50633:()=>{}}]);