!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.nemo=t():e.nemo=t()}(this,()=>(()=>{"use strict";var e={9373(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHelper=void 0,t.TypeHelper=class{isJsonString(e){try{JSON.parse(e)}catch(e){return!1}return!0}GetObjectType(e){return Object.prototype.toString.call(e)}isArray(e){return"[object Array]"==this.GetObjectType(e)}isString(e){return"[object String]"===this.GetObjectType(e)}isNumber(e){return"[object Number]"===this.GetObjectType(e)}isNull(e){return null==e}isFunction(e){return"[object Function]"===this.GetObjectType(e)}isObject(e){return"[object Object]"===this.GetObjectType(e)}isBool(e){return"[object Boolean]"===this.GetObjectType(e)}isBooleanConstructor(e){return"function Boolean() { [native code] }"==e?.toString()}isStringConstructor(e){return"function String() { [native code] }"==e?.toString()}isArrayConstructor(e){return"function Array() { [native code] }"==e?.toString()}isObjectConstructor(e){return"function Object() { [native code] }"==e?.toString()}isNumberConstructor(e){return"function Number() { [native code] }"==e?.toString()}isDateString(e){return!!this.isString(e)&&!isNaN(Date.parse(e))}isDate(e){return"[object Date]"===this.GetObjectType(e)}isFile(e){return"[object File]"===this.GetObjectType(e)}isBlob(e){return new Blob([e])instanceof Blob}cloneObject(e){var t;if(null==e||"object"!=typeof e)return e;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(Array.isArray(e)){t=[];for(var r=0,n=e.length;r<n;r++)t[r]=this.cloneObject(e[r]);return t}if("object"==typeof e){for(var o in t=e.constructor&&e.constructor.length<1?new e.constructor:{},e)e.hasOwnProperty(o)&&(t[o]=this.cloneObject(e[o]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}}},37748(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.QJsonHelper=t.CompSearchKey=void 0;const n=r(9373);var o;!function(e){e[e.PID=0]="PID",e[e.EditorID=1]="EditorID",e[e.Render=2]="Render"}(o||(t.CompSearchKey=o={}));class i{static ForEachComp(e,t,r,n){var o=function({curJson:e,path:r,parentCompJson:i,compiledJson:s}){if(!e||0===e.length)return void console.error("curJson is empty or undefined");const a=n?-1:1,c=n?e.length-1:0,p=n?-1:e.length;for(let n=c;n!==p;n+=a){const a=e[n],c=s?.[n];if(a){if(r.push(n),!1===t(a,r.map(e=>e),{compName:a.T,eID:a._Editor.eID,parentCompJson:i,compiledJson:c}))return!1;if(a.C)for(var l in a.C){if(r.push(l),!1===o({curJson:a.C[l].c,path:r,parentCompJson:a,compiledJson:c?.C[l]?.c}))return!1;r.pop()}r.pop()}}};o({curJson:e,path:[],compiledJson:r})}static findComponentByType(e,t){let r;return i.ForEachComp(e,e=>e.T!=t||(r=e,!1)),r}findParentArrayPath(e,t){return i.FindParentArrayPath(e,t)}static FindParentArrayPath(e,t){let r=null;const o=e.pop();if(0==e.length)return{selfIndex:o,parentArray:t,parent:null};let i=t;const s=new n.TypeHelper;for(let t=0;t<e.length;t++){const n=e[t];s.isObject(i)?(r=i,i=r?.C[n]?.c||[]):i=i[n]||[]}return{selfIndex:o,parentArray:i,parent:r}}findCompBySearchField(e,t,r=o.EditorID){return i.FindCompBySearchField(e,t,r)}static FindCompBySearchField(e,t,r=o.EditorID,n){let s=null;return i.ForEachComp(e,(e,n)=>(e=>{switch(r){case o.PID:return e.P?.ID?.H;case o.Render:return e.P?.Render?.H;case o.EditorID:default:return e._Editor?.eID}})(e)!==t||(s={compJson:e,curPath:n},!1),void 0,n),s}static ParseParameters(e,t){if(e){const r="TS"==t||"JS"==t?e=>({name:e.split(":")[0],type:e.split(":")[1]}):e=>({name:e});return e.split(",").map(r)}}static FindCompPathByEID(e,t){let r;return i.ForEachComp(e,(e,n)=>e._Editor.eID!=t||(r=n,!1)),r}}t.QJsonHelper=i},43659(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GhostContants=void 0;class r{}t.GhostContants=r,r.Name="Ghost"},61194(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.InspireTreeHelper=void 0;const n=r(37748),o=r(43659);t.InspireTreeHelper=class{createInspireTreeCommands(e,t){const r=[],n=(e,t,o,i)=>{const s=e.length>t.length?e.length:t.length;for(let a=0;a<s;a++){i++;const s=e[a],c=t[a],p=o.map(e=>e);if(p.push(i),s&&!c)return r.push({path:p,item:s,type:"add"}),void n(e.slice(a+1),[],o,i);if(!s&&c)return r.push({path:p,item:c,type:"delete"}),i--,void n([],t.slice(a+1),o,i);if(!this.isEqual(s,c)){const l=e[a+1],u=t[a+1];return l||u?l&&!u?(r.push({path:p,item:s,type:"add"}),void(this.isEqual(l,c)||n(e.slice(a+1),[],o,i))):!l&&u?(r.push({path:p,item:c,type:"delete"}),i--,void(this.isEqual(s,u)||n([],t.slice(a+1),o,i))):this.isEqual(l,c)?(r.push({path:p,item:s,type:"add"}),void n(e.slice(a+1),t.slice(a),o,i)):(r.push({path:p,item:c,type:"delete"}),i--,void n(e.slice(a),t.slice(a+1),o,i)):(r.push({path:p,item:s,type:"update"}),void n(e.slice(a+1),t.slice(a+1),o,i))}{const e=this.getSafeChildNode(s.children),t=this.getSafeChildNode(c.children),r=o.map(e=>e);r.push(i),n(e,t,r,-1)}}};return n(t,e.currentTreeData,[],-1),r}isEqual(e,t){return!e&&!t||!(!e||!t)&&e.text==t.text}getSafeChildNode(e){return e&&!0!==e?e:[]}createInspireTreeEditorDisplayName(e,t){if(!t)return;const r={};let o={},i={customCompValues:{},editorDisplayNames:{}};return n.QJsonHelper.ForEachComp(t,(t,n)=>{let s=e.getComponentPim(t.T),a=e.pimManager.GetComponentList();if("CustomComponent"==t.T){let e=!1;Object.keys(a).forEach(r=>{let n=a[r];Object.keys(n.Component?.Properties).forEach(c=>{if("QJsonPath"==n.Component?.Properties[c].Name&&n.Component?.Properties[c].DefaultValue?.EditorDefault==t.P.QJsonPath?.H&&s?.EditorDisplayName){const n="RenderingComponent"==a[r].Component.Name?s.EditorDisplayName:a[r].Component.Name;o[t._Editor.eID]=n,i.customCompValues=o,e=!0}})}),!e&&s?.EditorDisplayName&&(o[t._Editor.eID]=s.EditorDisplayName,i.customCompValues=o)}else s?.EditorDisplayName&&(r[t.T]||(r[t.T]=s.EditorDisplayName,i.editorDisplayNames=r));return!0}),i}createInspireTreeJson(e,t){if(!e||!t)return[];const r=[],o=e=>"CustomComponent"==e.T?t.customCompValues?.[e._Editor.eID]:t.editorDisplayNames?.[e.T];return n.QJsonHelper.ForEachComp(e,(e,t)=>{const n=(e,t)=>{const i=o(e),s=this.createInspireItem(e,i);if(Object.keys(e.C).forEach(t=>{e.C[t].c.filter(e=>null!=e).map(e=>{let t;if(s.children=s.children||[],e?.C)t=n(e,!0);else{const r=o(e);t=this.createInspireItem(e,r)}s.children.push(t)})}),t)return s;r.push(s)};return n(e,1!=t?.length),!0}),r}createInspireItem(e,t){const r={text:(t??e.T)+"("+e.P.ID.H+")",EID:e._Editor.eID,compType:e.T,O:{cType:e.O?.cType},nativeCompType:e.CP?.includes("<<named:")?"namedComponent":void 0};return e.T==o.GhostContants.Name&&(r.itree={state:{"drop-target":!1,draggable:!1,selectable:!1,focused:!1,selected:!1}}),e.O&&0===Object.keys(e.O).length&&(r.itree={state:{"drop-target":!1}}),r}}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}var n={};return(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.InspireTreeWorker=void 0;const t=r(61194);class o{constructor(){this.inspireTreeHelper=new t.InspireTreeHelper}}e.InspireTreeWorker=o;const i=self,s=new o;i.onmessage=function(e){setTimeout(()=>{const t=e.data,r=s.inspireTreeHelper.createInspireTreeJson(t.pjson,t.editorDisplayNames);if(t.recreate)return void a({treeData:r,recreate:t.recreate});const n=s.inspireTreeHelper.createInspireTreeCommands(t,r);a({comamnds:n,treeData:r,recreate:t.recreate})},50)};const a=function(e){i.postMessage(e)};e.default=null})(),n})());